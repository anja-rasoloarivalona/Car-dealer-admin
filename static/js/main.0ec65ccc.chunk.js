(this.webpackJsonpadmin=this.webpackJsonpadmin||[]).push([[0],{113:function(e,t,a){e.exports=a.p+"static/media/sprite.737c6dbb.svg"},121:function(e,t,a){e.exports=a.p+"static/media/eventually.b5e7acad.mp3"},123:function(e,t,a){e.exports=a(321)},128:function(e,t,a){},129:function(e,t,a){},134:function(e,t,a){},135:function(e,t,a){},152:function(e,t,a){},154:function(e,t,a){},155:function(e,t,a){},156:function(e,t,a){},158:function(e,t,a){},159:function(e,t,a){},160:function(e,t,a){},161:function(e,t,a){},162:function(e,t,a){},163:function(e,t,a){},255:function(e,t,a){},256:function(e,t,a){},258:function(e,t,a){},261:function(e,t,a){},262:function(e,t,a){},263:function(e,t,a){},269:function(e,t,a){},270:function(e,t,a){},271:function(e,t,a){},272:function(e,t,a){},276:function(e,t,a){},277:function(e,t,a){},278:function(e,t,a){},279:function(e,t,a){},308:function(e,t){},311:function(e,t,a){},312:function(e,t,a){},313:function(e,t,a){},314:function(e,t,a){},315:function(e,t,a){},316:function(e,t,a){},317:function(e,t,a){},318:function(e,t,a){},319:function(e,t,a){},320:function(e,t,a){},321:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(51),c=a.n(s),i=a(18),o=a(4),l=a(5),u=a(7),d=a(6),m=a(8),_=(a(128),a(26)),p=(a(129),a(10)),h=Object(p.b)((function(e){return{showFullNavbar:e.nav.showFullNavbar}}))((function(e){return r.a.createElement("div",{className:"loader-container ".concat(!0===e.showFullNavbar?"":"expand","\n                        ").concat(e.fullView?"full":"")},r.a.createElement("div",{className:"loader"},r.a.createElement("div",{className:"loader__bar"}),r.a.createElement("div",{className:"loader__bar"}),r.a.createElement("div",{className:"loader__bar"}),r.a.createElement("div",{className:"loader__bar"}),r.a.createElement("div",{className:"loader__bar"}),r.a.createElement("div",{className:"loader__ball"})))})),f=a(14),g=a(2),v=(a(134),a(3)),E=(a(135),a(75)),b=a.n(E),y=(a(151),a(152),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={showList:!1},a.toggleList=function(){a.setState((function(e){return Object(g.a)({},e,{showList:!e.showList})}))},a.handleClick=function(e){a.target&&a.target.contains(e.target)||a.state.showList&&a.toggleList()},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){document.addEventListener("mousedown",this.handleClick,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClick,!1)}},{key:"render",value:function(){var e=this,t=this.props.list,a=this.state.showList;return r.a.createElement("div",{className:"drop-down-list ".concat(a?"show":""),ref:function(t){return e.target=t},onClick:this.toggleList},r.a.createElement("div",{className:"drop-down-list__value"},this.props.value),r.a.createElement("ul",{className:"drop-down-list__list"},t.map((function(t){return r.a.createElement("li",{className:"drop-down-list__list__item\n                                        ".concat(t.value&&e.props.value==t.value?"active":"","\n                                        ").concat(t.text&&e.props.value==t.text?"active":"","\n                                        ").concat(e.props.value==t?"active":""),key:t.text?t.text:t,onClick:function(){return e.props.selectItemHandler(t.value?t.value:t)}},t.text?t.text:t)}))))}}]),t}(n.Component)),N=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(e){}},{key:"render",value:function(){var e=this,t=this.props.query,a=this.props.bodyTypeList,n=this.props.brandAndModelsData,s=Object.keys(n),c=[];"all"!==t.bodyType&&(Object.keys(n).forEach((function(e){Object.keys(n[e]).includes(t.bodyType)&&c.push(e)})),s=c);var i=[];"all"!==t.brand&&("all"===t.bodyType?Object.keys(n[t.brand]).forEach((function(e){i=[].concat(Object(v.a)(i),Object(v.a)(n[t.brand][e]))})):i=[].concat(Object(v.a)(i),Object(v.a)(n[t.brand][t.bodyType])));var o=this.props.suppliers,l=[];return o.forEach((function(e){l.push(e.name)})),r.a.createElement("div",{className:"inventory__controller"},r.a.createElement(y,{value:"all"===t.bodyType?"all body types":t.bodyType,list:[{text:"all body types",value:"all"}].concat(Object(v.a)(a)),selectItemHandler:this.props.selectBodyTypeHandler}),r.a.createElement(y,{value:"all"===t.brand?"all brands":t.brand,list:[{text:"all brands",value:"all"}].concat(Object(v.a)(s)),selectItemHandler:this.props.selectBrandHandler}),r.a.createElement(y,{value:"all"===t.model?"all models":t.model,list:"all"!==t.brand?[{text:"all models",value:"all"}].concat(Object(v.a)(i)):["all models"],selectItemHandler:this.props.selectModelHandler}),t.sort&&r.a.createElement(y,{value:t.sort,list:["increasing price","decreasing price","latest","most popular"],selectItemHandler:this.props.sortHandler}),r.a.createElement(y,{value:"all"===t.supplierName?"all suppliers":t.supplierName,list:[{value:"all",text:"all suppliers"}].concat(l),selectItemHandler:this.props.selectSupplierHandler}),r.a.createElement("div",{className:"inventory__controller__group"},r.a.createElement("div",{className:"inventory__controller__group__infos"},r.a.createElement("div",{className:"inventory__controller__group__infos__key"},"Price"),r.a.createElement("div",{className:"inventory__controller__group__infos__value"},t.price.value.min," - ",t.price.value.max)),r.a.createElement(b.a,{step:1e3,maxValue:t.price.scope.max,minValue:t.price.scope.min,value:t.price.value,onChange:function(t){return e.props.changePriceHandler(t)},onChangeComplete:this.props.changeComplete})),r.a.createElement("div",{className:"inventory__controller__group"},r.a.createElement("div",{className:"inventory__controller__group__infos"},r.a.createElement("div",{className:"inventory__controller__group__infos__key"},"Year"),r.a.createElement("div",{className:"inventory__controller__group__infos__value"},t.year.value.min," - ",t.year.value.max)),r.a.createElement(b.a,{maxValue:t.year.scope.max,minValue:t.year.scope.min,value:t.year.value,onChange:function(t){return e.props.changeYearHandler(t)},onChangeComplete:this.props.changeComplete})))}}]),t}(n.Component),P=Object(p.b)((function(e){return{brandAndModelsData:e.products.brandAndModelsData,price:e.products.price,bodyTypeList:e.products.bodyTypeList,suppliers:e.suppliers.suppliers}}))(N),S=a(112),w=a.n(S),C=function(e){return{type:"SET_REQUESTED_PRODUCT",product:e}},O=function(e){return{type:"SET_REQUESTED_PRODUCT_ID",id:e}},I=function(e){return console.log("seetingtgtrg"),{type:"SET_SUPPLIERS",suppliers:e}},j=function(e){return{type:"SET_ERROR",data:e}},k=(a(154),a(155),a(156),a(113)),T=a.n(k),D=function(e){return r.a.createElement("svg",{viewBox:"0 0 16 16",onClick:e.onClick,className:"icon icon-".concat(e.icon," ").concat(e.size," ").concat(e.customClass),xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r.a.createElement("use",{xlinkHref:"".concat(T.a,"#icon-").concat(e.icon)}))},H=function(e){return r.a.createElement("article",{className:"product"},e.children,r.a.createElement("div",{className:"product__imgContainer",onClick:e.goToProd},r.a.createElement("div",{className:"product__imgContainer__hoverLayer"}),r.a.createElement("img",{src:e.mainImg,alt:"main img",className:"product__img"}),r.a.createElement(D,{icon:"search"})),r.a.createElement("div",{className:"product__details"},r.a.createElement("div",{className:"product__details__model"},r.a.createElement("span",null,e.title),r.a.createElement("span",null,e.year)),r.a.createElement("div",{className:"product__details__price"},e.price.toLocaleString()," MRU")),r.a.createElement("ul",{className:"product__specList"},r.a.createElement("li",{className:"product__specList__item"},r.a.createElement("span",null,e.nbKilometers),r.a.createElement(D,{icon:"road"})),r.a.createElement("li",{className:"product__specList__item"},r.a.createElement("span",null,e.gazol),r.a.createElement(D,{icon:"gas-station"})),r.a.createElement("li",{className:"product__specList__item"},r.a.createElement("span",null,e.transmissionType),r.a.createElement(D,{icon:"gear"}))))},U=Object(_.f)((function(e){var t=e.productsList;return r.a.createElement("ul",{className:"products-list"},t.map((function(t){return r.a.createElement("li",{key:t._id,className:"products-list__item"},r.a.createElement(H,{id:t._id,mainImg:t.general.mainImgUrl,title:t.general.title,brand:t.general.brand,model:t.general.model,year:t.general.year,price:t.general.price,nbKilometers:t.general.nbKilometers,gazol:t.general.gazol,transmissionType:t.general.transmissionType,goToProd:function(){return a=t,e.history.push("/inventory/".concat(a._id,"?brand=").concat(a.general.brand,"&model=").concat(a.general.model,"&price=").concat(a.general.price)),void(e.fetchProductDetailsHandler&&e.fetchProductDetailsHandler(a));var a}}))})))})),F=(a(158),function(e){for(var t=[],a=1;a<=e.lastPage;a++)t.push(a);var n=t.map((function(t){return r.a.createElement("div",{onClick:e.onRequestPageNumber.bind(void 0,t),key:t,id:t,className:"paginator__control ".concat(e.currentPage===t?"active":" ")},t)}));return r.a.createElement("div",{className:"paginator"},e.children,e.products&&e.products.length>0&&r.a.createElement("div",{className:"paginator__controls ".concat(1===e.currentPage&&e.products.length<e.itemsPerPage?"hide":" ")},r.a.createElement("div",{className:"paginator__control\n                                ".concat(1===e.currentPage?"disabled":""),onClick:e.onRequestPreviousPage},r.a.createElement(D,{icon:"arrow-left"})),n,r.a.createElement("div",{className:"paginator__control\n                                ".concat(e.currentPage===e.lastPage?"disabled":""),onClick:e.onRequestNextPage},r.a.createElement(D,{icon:"arrow-right"}))))}),x=function(e,t,a,n){var r,s=n.USDCAD,c=n.USDEUR;return"CAD"===t&&("USD"===a&&(r=e/s),"EUR"===a&&(r=e/s*c),"CAD"===a&&(r=e)),"USD"===t&&("CAD"===a&&(r=e*s),"EUR"===a&&(r=e*c)),"EUR"===t&&("USD"===a&&(r=e/c),"CAD"===a&&(r=e/c*s)),r},L=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={products:null,loading:!0,query:{brand:"all",model:"all",bodyType:"all",supplierName:"all",supplierId:null,page:1,year:{value:{min:2008,max:2020},scope:{min:2008,max:2020}},price:{value:{min:null,max:null},scope:{min:null,max:null},init:{min:null,max:null}},sort:"increasing price"},lastPage:null},a.fetchProductsHandler=function(){var e,t=a.state.query,n=new URL("https://africauto.herokuapp.com/product/admin"),r=t.price.value.min,s=t.price.value.max,c=r,i=s;r=x(t.price.fullValue.min,a.props.currency,"CAD",a.props.quotes),s=x(t.price.fullValue.max,a.props.currency,"CAD",a.props.quotes),t&&(e=Object(g.a)({},e,{page:t.page,brand:t.brand,bodyType:t.bodyType,model:t.model,supplierId:t.supplierId,minPrice:Math.floor(r),maxPrice:Math.ceil(s),minYear:t.year.value.min,maxYear:t.year.value.max,sort:t.sort.split(" ").length>0?"".concat(t.sort.split(" ")[0],"_").concat(t.sort.split(" ")[1]):t.sort}),n.search=new URLSearchParams(e).toString()),fetch(n,{headers:{"Content-type":"application/json"}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Error fetching products");return e.json()})).then((function(e){a.setState({products:e.products,loading:!1}),a.props.history.push({pathname:"/inventory",search:"supplier=".concat(t.supplierName,"&sort=").concat(t.sort,"&page=").concat(t.page,"&bodyType=").concat(t.bodyType,"&brand=").concat(t.brand,"&model=").concat(t.model,"&minPrice=").concat(c,"&maxPrice=").concat(i,"&minYear=").concat(t.year.value.min,"&maxYear=").concat(t.year.value.max)})})).catch((function(e){console.log(e)}))},a.selectBodyTypeHandler=function(e){var t,n=a.props.brandAndModelsData,r=a.state.query;t="all"!==r.brand?Object.keys(n[r.brand]).includes(e)?Object(g.a)({},a.state.query,{bodyType:e}):Object(g.a)({},a.state.query,{bodyType:e,brand:"all",model:"all",page:1}):Object(g.a)({},a.state.query,{bodyType:e}),a.setState({query:t},(function(){return a.fetchProductsHandler(t)}))},a.selectBrandHandler=function(e){var t=Object(g.a)({},a.state.query,{brand:e});"all"===e&&(t=Object(g.a)({},t,{model:"all",page:1})),a.setState({query:t},(function(){return a.fetchProductsHandler(t)}))},a.selectModelHandler=function(e){a.setState((function(t){return Object(g.a)({},t,{query:Object(g.a)({},t.query,{model:e})})}),(function(){return a.fetchProductsHandler()}))},a.sortHandler=function(e){a.setState((function(t){return Object(g.a)({},t,{query:Object(g.a)({},t.query,{sort:e,page:1})})}),(function(){return a.fetchProductsHandler()}))},a.selectSupplierHandler=function(e){if("all"===e)a.setState((function(e){return Object(g.a)({},e,{query:Object(g.a)({},e.query,{supplierName:"all",supplierId:null})})}),(function(){return a.fetchProductsHandler()}));else{var t=a.props.suppliers.find((function(t){return t.name===e}))._id;a.setState((function(a){return Object(g.a)({},a,{query:Object(g.a)({},a.query,{supplierName:e,supplierId:t})})}),(function(){return a.fetchProductsHandler()}))}},a.changePriceHandler=function(e){a.setState((function(t){return Object(g.a)({},t,{query:Object(g.a)({},t.query,{page:1,price:Object(g.a)({},t.query.price,{value:e,fullValue:e})})})}))},a.changeYearHandler=function(e){a.setState((function(t){return Object(g.a)({},t,{query:Object(g.a)({},t.query,{page:1,year:Object(g.a)({},t.query.year,{value:e})})})}))},a.changeComplete=function(){a.fetchProductsHandler()},a.paginationHandler=function(e){var t=a.state.query;"next"===e&&a.props.currentInventoryPage<a.state.lastPage&&(t=Object(g.a)({},t,{page:a.props.currentInventoryPage+1}),a.props.setInventoryCurrentPage(a.props.currentInventoryPage+1),a.setState({query:t},(function(){return a.fetchProductsHandler()}))),"previous"===e&&a.props.currentInventoryPage>1&&(t=Object(g.a)({},t,{page:a.props.currentInventoryPage-1}),a.props.setInventoryCurrentPage(a.props.currentInventoryPage-1),a.setState({query:t},(function(){return a.fetchProductsHandler()}))),"previous"!==e&&"next"!==e&&(t=Object(g.a)({},t,{page:e}),a.props.setInventoryCurrentPage(e),a.setState({query:t},(function(){return a.fetchProductsHandler()})))},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){var e=this,t=this.props.price.min,a=this.props.price.max,n=w.a.parse(this.props.location.search);Object.keys(n).length>2?(n.page>1&&this.props.setInventoryCurrentPage(parseInt(n.page)),this.setState((function(r){return Object(g.a)({},r,{query:Object(g.a)({},r.query,{price:{init:{min:t,max:a},scope:{min:t,max:a},value:{min:parseInt(n.minPrice),max:parseInt(n.maxPrice)},fullValue:{min:parseInt(n.minPrice),max:parseInt(n.maxPrice)}},year:Object(g.a)({},r.query.year,{value:{min:parseInt(n.minYear),max:parseInt(n.maxYear)}}),supplierName:n.supplier,supplierId:"all"===n.supplier?null:e.props.suppliers.find((function(e){return e.name===n.supplier}))._id,brand:n.brand,model:n.model,sort:n.sort,bodyType:n.bodyType,page:n.page}),lastPage:Math.ceil(e.props.totalProductsCounter/e.props.itemsPerPage)})}),(function(){return e.fetchProductsHandler()}))):this.setState((function(n){return Object(g.a)({},n,{query:Object(g.a)({},n.query,{price:{init:{min:t,max:a},scope:{min:t,max:a},value:{min:t,max:a},fullValue:{min:t,max:a}}}),lastPage:Math.ceil(e.props.totalProductsCounter/e.props.itemsPerPage)})}),(function(){return e.fetchProductsHandler()}))}},{key:"componentDidUpdate",value:function(e){var t=this,a=e.currency,n=this.props.currency,r=this.state.query;if(a!==n){var s=this.props.quotes;this.setState((function(e){return Object(g.a)({},e,{query:Object(g.a)({},e.query,{price:Object(g.a)({},e.query.price,{scope:{min:1e3*Math.floor(x(r.price.init.min,"CAD",n,s)/1e3),max:1e3*Math.ceil(x(r.price.init.max,"CAD",n,s)/1e3)},value:{min:1e3*Math.floor(x(r.price.init.min,"CAD",n,s)/1e3),max:1e3*Math.ceil(x(r.price.init.max,"CAD",n,s)/1e3)},fullValue:{min:x(r.price.init.min,"CAD",n,s),max:x(r.price.init.max,"CAD",n,s)}})})})}),(function(){return t.fetchProductsHandler()}))}}},{key:"render",value:function(){var e=this.state,t=e.products,a=e.loading,n=e.query,s=r.a.createElement(h,null);return a||(s=r.a.createElement("div",{className:"inventory"},r.a.createElement(P,{currency:this.props.currency,query:n,selectBrandHandler:this.selectBrandHandler,selectModelHandler:this.selectModelHandler,selectBodyTypeHandler:this.selectBodyTypeHandler,sortHandler:this.sortHandler,changePriceHandler:this.changePriceHandler,changeYearHandler:this.changeYearHandler,changeComplete:this.changeComplete,data:this.props.brandAndModelsData,selectSupplierHandler:this.selectSupplierHandler}),r.a.createElement("section",{className:"inventory__container"},t&&r.a.createElement(F,{onRequestPreviousPage:this.paginationHandler.bind(this,"previous"),onRequestNextPage:this.paginationHandler.bind(this,"next"),lastPage:Math.ceil(this.props.totalProductsCounter/this.props.itemsPerPage),currentPage:this.props.currentInventoryPage,onRequestPageNumber:this.paginationHandler,products:t,itemsPerPage:this.props.itemsPerPage},r.a.createElement(U,{productsList:t}))))),s}}]),t}(n.Component),M=Object(p.b)((function(e){var t;return t={brandAndModelsData:e.products.brandAndModelsData,price:e.products.price,totalProductsCounter:e.products.totalProducts,currentInventoryPage:e.products.currentInventoryPage,itemsPerPage:e.products.itemsPerPage,currency:e.parameters.currency,quotes:e.parameters.quotes,lang:e.parameters.lang},Object(f.a)(t,"currency",e.parameters.currency),Object(f.a)(t,"suppliers",e.suppliers.suppliers),t}),(function(e){return{setInventoryCurrentPage:function(t){return e({type:"SET_CURRENT_PAGE",page:t})}}}))(L),A=(a(159),a(160),function(e){return e.link?r.a.createElement(i.b,{className:["button","button--".concat(e.color)].join(" "),to:e.link,onClick:e.onClick},e.children):r.a.createElement("button",{className:["button","button--".concat(e.color)].join(" "),onClick:e.onClick,disabled:e.disabled||e.loading,type:e.type},e.loading?"Looading...":e.children)}),B=(a(161),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={products:null,loading:!0},a.fetchProductsHandler=function(){a.setState({loading:!0});var e={section:a.props.selectorTitle};fetch("http://localhost:8000/admin/publicity/add-new",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Could not fetch suppliers");return e.json()})).then((function(e){a.setState({products:e.products,loading:!1})})).catch((function(e){console.log(e),a.setState({loading:!1})}))},a.selectHandler=function(e){var t=a.props,n=t.selectorSelectedProductsIds,r=t.selectorSelectedProductsDetails,s=e._id,c={};n.includes(s)?(c.productsIds=n.filter((function(e){return e!==s})),c.productsDetails=r.filter((function(e){return e._id!==s}))):(c.productsIds=[].concat(Object(v.a)(n),[s]),c.productsDetails=[].concat(Object(v.a)(r),[e])),a.props.setPublicitySelectorSelectedProducts(c)},a.requestProductDetails=function(e){a.props.setProductRequestedId(e),a.props.history.push("/inventory/".concat(e))},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.fetchProductsHandler();var e=[],t=[],a=[],n=this.props.selectorTitle;if("publicity"===n&&(a=this.props.newPubProducts),"home page"===n&&(a=this.props.newHomePageProducts),a.length>0){a.forEach((function(a){e=[].concat(Object(v.a)(e),[a._id]),t=[].concat(Object(v.a)(t),[a])}));var r={productsIds:e,productsDetails:t};this.props.setPublicitySelectorSelectedProducts(r)}}},{key:"render",value:function(){var e=this,t=this.state,a=t.products,s=t.loading,c=this.props,i=c.selectorSelectedProductsIds,o=c.selectorSelectedProductsDetails,l=r.a.createElement(h,null);return s||(l=r.a.createElement(n.Fragment,null,r.a.createElement("ul",{className:"publicity__main__list"},a&&a.map((function(t){return r.a.createElement("li",{key:t._id},r.a.createElement(H,{id:t._id,mainImg:t.general.mainImgUrl,title:t.general.title,brand:t.general.brand,model:t.general.model,year:t.general.year,price:t.general.price,nbKilometers:t.general.nbKilometers,gazol:t.general.gazol,transmissionType:t.general.transmissionType,goToProd:function(){return e.requestProductDetails(t._id)}},r.a.createElement("div",{className:"publicitySelector__checkbox \n                                                                    ".concat(i.includes(t._id)?"checked":""),onClick:function(){return e.selectHandler(t)}},r.a.createElement(D,{icon:"checked"}))))}))),r.a.createElement("div",{className:"publicitySelector__cta"},r.a.createElement(A,{color:"primary",onClick:function(){return e.props.addNewProducts(o)}},"Add"),r.a.createElement(A,{color:"primary",onClick:this.props.toggleSelector},"Cancel")))),r.a.createElement("div",{className:"publicitySelector"},r.a.createElement("h1",{className:"publicitySelector__title"},"Select ",this.props.selectorTitle," products"),l)}}]),t}(n.Component)),q=Object(p.b)((function(e){return{selectorSelectedProductsIds:e.publicity.selectorSelectedProductsIds,selectorSelectedProductsDetails:e.publicity.selectorSelectedProductsDetails,newPubProducts:e.publicity.newPubProducts,newHomePageProducts:e.publicity.newHomePageProducts}}),(function(e){return{setProductRequestedId:function(t){return e(O(t))},setPublicitySelectorSelectedProducts:function(t){return e(function(e){return{type:"SET_PUBLICITY_SELECTOR_SELECTED_PRODUCTS",productsIds:e.productsIds,productsDetails:e.productsDetails}}(t))}}}))(Object(_.f)(B)),R=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!0},a.fetchProductsHandler=function(){a.setState({loading:!0});fetch("https://africauto.herokuapp.com/admin/publicity",{headers:{"Content-Type":"application/json"}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Could not fetch suppliers");return e.json()})).then((function(e){var t={pubProducts:e.publicity,homePageProducts:e.home};a.props.setPublicityData(t),a.setState({loading:!1})})).catch((function(e){console.log(e),a.setState({loading:!1})}))},a.requestProductDetails=function(e){a.props.setProductRequestedId(e),a.props.history.push("/inventory/".concat(e))},a.editingModeHandler=function(e){var t,n=a.props.editingMode;n?n.includes(e)?a.cancelHandler(e):(t=[].concat(Object(v.a)(n),[e]),a.props.setPublicityEditingMode(t)):(t=[e],a.props.setPublicityEditingMode(t))},a.selectHandler=function(e,t){var n=a.props,r=n.selectedPubProducts,s=n.selectedHomePageProducts,c=[];"publicity"===e&&(c=r.includes(t)?r.filter((function(e){return e!==t})):[].concat(Object(v.a)(r),[t]),a.props.setPublicitySelectedPubProducts(c)),"home page"===e&&(c=s.includes(t)?s.filter((function(e){return e!==t})):[].concat(Object(v.a)(s),[t]),a.props.setPublicitySelectedHomePageProducts(c))},a.deleteHandler=function(e){if("publicity"===e){var t=a.props.currentPubProducts.filter((function(e){return!a.props.selectedPubProducts.includes(e._id)}));a.props.deletePublicitySelectedPubProducts(t)}if("home page"===e){var n=a.props.currentHomePageProducts.filter((function(e){return!a.props.selectedHomePageProducts.includes(e._id)}));a.props.deletePublicitySelectedHomePageProducts(n)}},a.cancelHandler=function(e){a.props.cancelPublicityEditingMode(e)},a.saveHandler=function(){var e=a.props,t=e.publicitySelectedProducts,n=e.newPubProducts,r=e.homePageSelectedProducts,s=e.newHomePageProducts,c=new FormData;if(c.append("removeFromPub",t),c.append("removeFromHomePage",r),n){var i=[];n.forEach((function(e){i=[].concat(Object(v.a)(i),[e._id])})),c.append("addToPub",i)}if(s){var o=[];s.forEach((function(e){o=[].concat(Object(v.a)(o),[e._id])})),c.append("addToHomePage",o)}fetch("https://africauto.herokuapp.com/admin/update-product-visibility",{headers:{"Content-Type":"application/json"},method:"PUT",body:JSON.stringify(Object.fromEntries(c))}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Creating a product failed");return e.json()})).then((function(e){a.fetchProductsHandler(),a.setState({editingMode:!1,newPubProducts:[],newHomePageProducts:[]})})).catch((function(e){console.log(e)}))},a.toggleSelector=function(e){a.props.togglePublicitySelector(e)},a.addNewPubProducts=function(e){var t=a.props.editingMode,n=a.props.selectorTitle;"publicity"===n&&(a.props.addPublicityPubProducts(e),t.includes("publicity")||a.editingModeHandler("publicity")),"home page"===n&&(a.props.addPublicityHomePageProducts(e),t.includes("home page")||a.editingModeHandler("home page")),a.props.togglePublicitySelector()},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.fetchProductsHandler()}},{key:"render",value:function(){var e=this,t=this.state.loading,a=this.props,n=a.currentPubProducts,s=a.currentHomePageProducts,c=a.editingMode,i=a.selectedPubProducts,o=a.selectedHomePageProducts,l=a.showSelector,u=a.selectorTitle,d=a.newPubProducts,m=a.newHomePageProducts,_=r.a.createElement(h,null);return t||(_=r.a.createElement("div",{className:"publicity"},l&&r.a.createElement(q,{toggleSelector:this.toggleSelector,addNewProducts:this.addNewPubProducts,selectorTitle:u}),r.a.createElement("section",{className:"publicity__section--main publicity__section"},r.a.createElement("h1",{className:"publicity__title"},"Publicity"),r.a.createElement("div",{className:"publicity__section__controller"},r.a.createElement(D,{icon:"add",onClick:function(){return e.toggleSelector("publicity")}}),r.a.createElement(D,{icon:"bin",customClass:"publicity__section__controller__delete",onClick:function(){return e.deleteHandler("publicity")}}),r.a.createElement(D,{icon:"pencil",customClass:"publicity__section__controller__edit",onClick:function(){return e.editingModeHandler("publicity")}})),r.a.createElement("ul",{className:"publicity__main__list"},n&&n.map((function(t){return r.a.createElement("li",{key:t._id},r.a.createElement(H,{id:t._id,mainImg:t.general.mainImgUrl,title:t.general.title,brand:t.general.brand,model:t.general.model,year:t.general.year,price:t.general.price,nbKilometers:t.general.nbKilometers,gazol:t.general.gazol,transmissionType:t.general.transmissionType,goToProd:function(){return e.requestProductDetails(t._id)}},r.a.createElement("div",{className:"publicity__main__list__item__checkbox\n                                                                ".concat(i.includes(t._id)?"checked":"","\n                                                                ").concat(c&&c.includes("publicity")?"show":""),onClick:function(){return e.selectHandler("publicity",t._id)}},r.a.createElement(D,{icon:"checked"}))))}))),d.length>0&&r.a.createElement("div",{className:"publicity__newProducts"},r.a.createElement("h2",{className:"publicity__newProducts__title"},"New products"),r.a.createElement("ul",{className:"publicity__main__list"},d&&d.map((function(t){return r.a.createElement("li",{key:t._id},r.a.createElement(H,{id:t._id,mainImg:t.general.mainImgUrl,title:t.general.title,brand:t.general.brand,model:t.general.model,year:t.general.year,price:t.general.price,nbKilometers:t.general.nbKilometers,gazol:t.general.gazol,transmissionType:t.general.transmissionType,goToProd:function(){return e.requestProductDetails(t._id)}},r.a.createElement("div",{className:"publicity__main__list__item__checkbox"},r.a.createElement(D,{icon:"checked"}))))})))),r.a.createElement("div",{className:"publicity__section__cta ".concat(c&&c.includes("publicity")?"show":"")},r.a.createElement(A,{color:"primary",onClick:this.saveHandler},"Save"),r.a.createElement(A,{color:"primary",onClick:function(){return e.cancelHandler("publicity")}},"Cancel"))),r.a.createElement("section",{className:"publicity__section--inventory publicity__section"},r.a.createElement("h1",{className:"publicity__title"},"Home Page"),r.a.createElement("div",{className:"publicity__section__controller"},r.a.createElement(D,{icon:"add",onClick:function(){return e.toggleSelector("home page")}}),r.a.createElement(D,{icon:"bin",customClass:"publicity__section__controller__delete",onClick:function(){return e.deleteHandler("home page")}}),r.a.createElement(D,{icon:"pencil",customClass:"publicity__section__controller__edit",onClick:function(){return e.editingModeHandler("home page")}})),r.a.createElement("ul",{className:"publicity__main__list"},s&&s.map((function(t){return r.a.createElement("li",{key:t._id},r.a.createElement(H,{id:t._id,mainImg:t.general.mainImgUrl,title:t.general.title,brand:t.general.brand,model:t.general.model,year:t.general.year,price:t.general.price,nbKilometers:t.general.nbKilometers,gazol:t.general.gazol,transmissionType:t.general.transmissionType,goToProd:function(){return e.requestProductDetails(t._id)}},r.a.createElement("div",{className:"publicity__main__list__item__checkbox\n                                                        ".concat(o.includes(t._id)?"checked":"","\n                                                        ").concat(c&&c.includes("home page")?"show":""),onClick:function(){return e.selectHandler("home page",t._id)}},r.a.createElement(D,{icon:"checked"}))))}))),m.length>0&&r.a.createElement("div",{className:"publicity__newProducts"},r.a.createElement("h2",{className:"publicity__newProducts__title"},"New products"),r.a.createElement("ul",{className:"publicity__main__list"},m&&m.map((function(t){return r.a.createElement("li",{key:t._id},r.a.createElement(H,{id:t._id,mainImg:t.general.mainImgUrl,title:t.general.title,brand:t.general.brand,model:t.general.model,year:t.general.year,price:t.general.price,nbKilometers:t.general.nbKilometers,gazol:t.general.gazol,transmissionType:t.general.transmissionType,goToProd:function(){return e.requestProductDetails(t._id)}},r.a.createElement("div",{className:"publicity__main__list__item__checkbox"},r.a.createElement(D,{icon:"checked"}))))})))),r.a.createElement("div",{className:"publicity__section__cta ".concat(c&&c.includes("home page")?"show":"")},r.a.createElement(A,{color:"primary",onClick:this.saveHandler},"Save"),r.a.createElement(A,{color:"primary",onClick:function(){return e.cancelHandler("home page")}},"Cancel"))))),_}}]),t}(n.Component),G=Object(p.b)((function(e){return{INIT_pubProducts:e.publicity.INIT_pubProducts,INIT_homePageProducts:e.publicity.INIT_homePageProducts,currentPubProducts:e.publicity.currentPubProducts,currentHomePageProducts:e.publicity.currentHomePageProducts,selectedPubProducts:e.publicity.selectedPubProducts,selectedHomePageProducts:e.publicity.selectedHomePageProducts,newPubProducts:e.publicity.newPubProducts,newHomePageProducts:e.publicity.newHomePageProducts,showSelector:e.publicity.showSelector,selectorTitle:e.publicity.selectorTitle,editingMode:e.publicity.editingMode}}),(function(e){return{setProductRequestedId:function(t){return e(O(t))},setPublicityData:function(t){return e(function(e){return{type:"SET_PUBLICITY_DATA",pubProducts:e.pubProducts,homePageProducts:e.homePageProducts}}(t))},setPublicityEditingMode:function(t){return e(function(e){return{type:"SET_PUBLICITY_EDITING_MODE",editingMode:e}}(t))},setPublicitySelectedPubProducts:function(t){return e(function(e){return{type:"SET_PUBLICITY_SELECTED_PUB_PRODUCTS",data:e}}(t))},setPublicitySelectedHomePageProducts:function(t){return e(function(e){return{type:"SET_PUBLICITY_SELECTED_HOMEPAGE_PRODUCTS",data:e}}(t))},cancelPublicityEditingMode:function(t){return e(function(e){return{type:"CANCEL_PUBLICITY_EDITING_MODE",section:e}}(t))},deletePublicitySelectedHomePageProducts:function(t){return e(function(e){return{type:"DELETE_PUBLICITY_SELECTED_HOMEPAGE_PRODUCTS",data:e}}(t))},deletePublicitySelectedPubProducts:function(t){return e(function(e){return{type:"DELETE_PUBLICITY_SELECTED_PUB_PRODUCTS",data:e}}(t))},togglePublicitySelector:function(t){return e(function(e){return{type:"TOGGLE_PUBLICITY_SELECTOR",section:e}}(t))},addPublicityPubProducts:function(t){return e(function(e){return{type:"ADD_PUBLICITY_PUB_PRODUCTS",data:e}}(t))},addPublicityHomePageProducts:function(t){return e(function(e){return{type:"ADD__PUBLICITY__HOMEPAGE__PRODUCTS",data:e}}(t))}}}))(R),V=(a(162),a(163),a(32)),z=function(e,t){return new Date(t,e,0).getDate()},Y=["January","February","March","April","May","June","July","August","September","October","November","December"],W=(a(255),function(e){return r.a.createElement("div",{className:"app__titleContainer"},r.a.createElement("h1",{className:"app__title--primary"},e.title),e.children)}),K=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={data:{labels:[],datasets:[]},tempData:null,mm_yyyy_labels:[],loading:!0,filter:"general",selectedMonth:null},a.selectFilterHandler=function(e){"general"===e&&a.setState({filter:e},(function(){return a.selectUsersConnectionFilterGeneral()})),"month"===e&&a.setState({filter:e},(function(){return a.selectUsersConnectionFilterByMonth()}))},a.selectUsersConnectionFilterByMonth=function(e){e||(e=a.state.selectedMonth);var t,n=e.split("-")[0],r=e.split("-")[1],s=z(parseInt(n),parseInt(r)),c=[];for(t=1;t<s+1;t++)t<10&&(t="0".concat(t)),c.push("".concat(t,"-").concat(n,"-").concat(r));var i={};Object.keys(a.state.tempData).forEach((function(t){"".concat(t.split("-")[1],"-").concat(t.split("-")[2])===e&&(i[t]=a.state.tempData[t])}));var o=[];c.forEach((function(e){o=Object.keys(i).includes(e)?[].concat(Object(v.a)(o),[i[e]]):[].concat(Object(v.a)(o),[0])}));var l=[];c.forEach((function(e){l.push(e.split("-")[0])}));var u={labels:l,datasets:[{label:"Number of website loadings - ".concat(Y[n-1]," ").concat(r),data:o,backgroundColor:"transparent"}]};a.setState({data:u,selectedMonth:e})},a.selectUsersConnectionFilterGeneral=function(){var e,t={},n=[];a.props.stats.forEach((function(e){e.connection.forEach((function(e){n.push(e)}))}));var r=[];n.forEach((function(e){var t=e.start.split("-")[0],a=e.start.split("-")[1],n=e.start.split("-")[2],s=new Date("".concat(a,"-").concat(t,"-").concat(n));r.push(s)})),r=r.sort((function(e,t){return e>t?1:e<t?-1:0}));var s=[];r.forEach((function(e){var t=e.getDate(),a=e.getMonth()+1,n=e.getFullYear();t<10&&(t="0".concat(t)),s.push("".concat(t,"-").concat(a,"-").concat(n))})),s.forEach((function(e){Object.keys(t).includes(e)?t[e]=t[e]+1:t[e]=1}));var c=[];Object.keys(t).forEach((function(e){c=[].concat(Object(v.a)(c),[t[e]])}));var i=[];Object.keys(t).forEach((function(e){var t="".concat(e.split("-")[1],"-").concat(e.split("-")[2]);i.includes(t)||i.push(t)})),e={labels:Object.keys(t),datasets:[{label:"Number of website loadings",data:c,backgroundColor:"transparent"}]},a.setState({data:e,tempData:t,mm_yyyy_labels:i,selectedMonth:i[0],loading:!1,statsUserConnectionFilter:"general",showUserConnectionFilterByMonthList:!1},(function(){return console.log(i)}))},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.selectUsersConnectionFilterGeneral()}},{key:"render",value:function(){var e=this,t=this.state,a=t.data,n=t.mm_yyyy_labels,s=t.loading,c=t.filter,i=t.selectedMonth,o=r.a.createElement("div",null,"loading");return s||(o=r.a.createElement("section",{className:"stats__section"},r.a.createElement(W,{title:"Website loadings"}),r.a.createElement("div",{className:"stats__userConnection__container"},r.a.createElement("div",{className:"stats__userConnection__filter"},r.a.createElement("h2",{className:"stats__userConnection__filter__title"},"Filtre"),r.a.createElement("ul",{className:"stats__userConnection__filter__list"},r.a.createElement("li",{className:"stats__userConnection__filter__list__item\n                                            ".concat("general"===c?"active":""),onClick:function(){return e.selectFilterHandler("general")}},"general"),r.a.createElement("li",{className:"stats__userConnection__filter__list__item\n                                            ".concat("month"===c?"active":""),onClick:function(){return e.selectFilterHandler("month")}},r.a.createElement("div",{className:"stats__userConnection__filter__list__item__key"},"Par mois"),r.a.createElement("div",{className:"stats__userConnection__filter__list__item__value"},Y[i.split("-")[0]-1].slice(0,3)," ",i.split("-")[1]),r.a.createElement("ul",{className:"stats__userConnection__filter__byMonthList\n                                                    ".concat("month"===c?"shown":"")},n.map((function(t){return r.a.createElement("li",{key:t,onClick:function(){return e.selectUsersConnectionFilterByMonth(t)},className:"stats__userConnection__filter__byMonthList__item\n                                                            ".concat(i===t?"active":"")},Y[t.split("-")[0]-1].slice(0,3)," ",t.split("-")[1])})))))),r.a.createElement("div",{className:"stats__userConnection__chartContainer"},r.a.createElement(V.a,{options:{responsive:!0,scales:{yAxes:[{ticks:{beginAtZero:!0,stepSize:1}}]}},data:a}))))),o}}]),t}(n.Component),J=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={data:{labels:[],datasets:[]},tempData:null,mm_yyyy_labels:[],loading:!0,filter:"general",selectedMonth:null},a.selectFilterHandler=function(e){"general"===e&&a.setState({filter:e},(function(){return a.selectUsersConnectionFilterGeneral()})),"month"===e&&a.setState({filter:e},(function(){return a.selectUsersConnectionFilterByMonth()}))},a.selectUsersConnectionFilterByMonth=function(e){e||(e=a.state.selectedMonth);var t,n=e.split("-")[0],r=e.split("-")[1],s=z(parseInt(n),parseInt(r)),c=[];for(t=1;t<s+1;t++)t<10&&(t="0".concat(t)),c.push("".concat(t,"-").concat(n,"-").concat(r));var i={};Object.keys(a.state.tempData).forEach((function(t){"".concat(t.split("-")[1],"-").concat(t.split("-")[2])===e&&(i[t]=a.state.tempData[t])}));var o=[];c.forEach((function(e){o=Object.keys(i).includes(e)?[].concat(Object(v.a)(o),[i[e].length]):[].concat(Object(v.a)(o),[0])}));var l=[];c.forEach((function(e){l.push(e.split("-")[0])}));var u={labels:l,datasets:[{label:"Number of connected users - ".concat(Y[n-1]," ").concat(r),data:o,backgroundColor:"transparent"}]};a.setState({data:u,selectedMonth:e})},a.selectUsersConnectionFilterGeneral=function(){var e,t={},n=[];a.props.stats.forEach((function(e){e.connection.forEach((function(t){t=Object(g.a)({},t,{userId:e._id}),n.push(t)}))}));var r=[];n.forEach((function(e){var t=e.start.split("-")[0],a=e.start.split("-")[1],n=e.start.split("-")[2],s=new Date("".concat(a,"-").concat(t,"-").concat(n));r.push(s)})),r=r.sort((function(e,t){return e>t?1:e<t?-1:0}));var s=[];r.forEach((function(e){var t=e.getDate(),a=e.getMonth()+1,n=e.getFullYear();t<10&&(t="0".concat(t)),s.includes("".concat(t,"-").concat(a,"-").concat(n))||s.push("".concat(t,"-").concat(a,"-").concat(n))})),s.forEach((function(e){t[e]=[]})),n.forEach((function(e){var a=e.start.split(" ")[0],n=e.userId;Object.keys(t).forEach((function(e){e!==a||t[e].includes(n)||t[e].push(n)}))}));var c=[];Object.keys(t).forEach((function(e){c=[].concat(Object(v.a)(c),[t[e].length])})),e={labels:Object.keys(t),datasets:[{label:"Number of connected users",data:c,backgroundColor:"transparent"}]};var i=[];Object.keys(t).forEach((function(e){var t="".concat(e.split("-")[1],"-").concat(e.split("-")[2]);i.includes(t)||i.push(t)})),a.setState({data:e,tempData:t,mm_yyyy_labels:i,selectedMonth:i[0],loading:!1,statsUserConnectionFilter:"general",showUserConnectionFilterByMonthList:!1})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.selectUsersConnectionFilterGeneral()}},{key:"render",value:function(){var e=this,t=this.state,a=t.data,n=t.mm_yyyy_labels,s=t.loading,c=t.filter,i=t.selectedMonth,o=r.a.createElement("div",null,"loading");return s||(o=r.a.createElement("section",{className:"stats__section"},r.a.createElement(W,{title:"Connected users"}),r.a.createElement("div",{className:"stats__userConnection__container"},r.a.createElement("div",{className:"stats__userConnection__filter"},r.a.createElement("h2",{className:"stats__userConnection__filter__title"},"Filtre"),r.a.createElement("ul",{className:"stats__userConnection__filter__list"},r.a.createElement("li",{className:"stats__userConnection__filter__list__item\n                                            ".concat("general"===c?"active":""),onClick:function(){return e.selectFilterHandler("general")}},"general"),r.a.createElement("li",{className:"stats__userConnection__filter__list__item\n                                            ".concat("month"===c?"active":""),onClick:function(){return e.selectFilterHandler("month")}},r.a.createElement("div",{className:"stats__userConnection__filter__list__item__key"},"Par mois"),r.a.createElement("div",{className:"stats__userConnection__filter__list__item__value"},Y[i.split("-")[0]-1].slice(0,3)," ",i.split("-")[1]),r.a.createElement("ul",{className:"stats__userConnection__filter__byMonthList\n                                                    ".concat("month"===c?"shown":"")},n.map((function(t){return r.a.createElement("li",{key:t,onClick:function(){return e.selectUsersConnectionFilterByMonth(t)},className:"stats__userConnection__filter__byMonthList__item\n                                                            ".concat(i===t?"active":"")},Y[t.split("-")[0]-1].slice(0,3)," ",t.split("-")[1])})))))),r.a.createElement("div",{className:"stats__userConnection__chartContainer"},r.a.createElement(V.a,{options:{responsive:!0,scales:{yAxes:[{ticks:{beginAtZero:!0,stepSize:1}}]}},data:a}))))),o}}]),t}(n.Component),Q=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={data:null,loading:!0,showBrandsData:[],maxFollowedProducts:0},a.showBrandsDataHandler=function(e){var t=[];t="show all"===e?Object.keys(a.state.data):"hide all"===e?[]:a.state.showBrandsData.includes(e)?a.state.showBrandsData.filter((function(t){return t!==e})):[].concat(Object(v.a)(a.state.showBrandsData),[e]),a.setState({showBrandsData:t})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.stats,t=[];for(var a in e)t.push([a,e[a].followers]);t.sort((function(e,t){return t[1]-e[1]}));var n=t[0][1],r={};t.forEach((function(t){var a=t[0];r[a]={followers:t[1],models:Object(g.a)({},e[a].models)}})),this.setState({data:r,maxFollowedProducts:n,loading:!1})}},{key:"render",value:function(){var e=this,t=this.state,a=t.data,s=t.loading,c=t.maxFollowedProducts,i=t.showBrandsData,o=this.props.mostFollowedProducts,l=r.a.createElement(h,null);return s||(l=r.a.createElement(n.Fragment,null,r.a.createElement("section",{className:"stats__section"},r.a.createElement(W,{title:"Favorite Products"},r.a.createElement("div",{className:"stats__section__title__cta"},r.a.createElement(A,{color:"primary",onClick:function(){return e.showBrandsDataHandler("show all")}},"Show"),r.a.createElement(A,{color:"primary",onClick:function(){return e.showBrandsDataHandler("hide all")}},"Hide"))),r.a.createElement("ul",{className:"stats__section__list"},Object.keys(a).map((function(t){return r.a.createElement("li",{className:"stats__section__list__item\n                                               ".concat(i.includes(t)?"showList":""),key:t},r.a.createElement("div",{className:"stats__section__list__item__brandContainer",onClick:function(){return e.showBrandsDataHandler(t)}},r.a.createElement("div",{className:"stats__section__list__item__brand"},t),r.a.createElement("div",{className:"stats__section__list__item__viewBar"},r.a.createElement("div",{className:"stats__section__list__item__viewBar__inner",style:{width:"".concat(a[t].followers/c*100,"%")}})),r.a.createElement("div",{className:"stats__section__list__item__viewCounter"},a[t].followers)),r.a.createElement("ul",{className:"stats__section__list__item__modelsList"},Object.keys(a[t].models).map((function(e){return r.a.createElement("li",{key:e,className:"stats__section__list__item__modelsList__item"},r.a.createElement("div",{className:"stats__section__list__item__modelsList__item__model"},e),r.a.createElement("div",{className:"stats__section__list__item__modelsList__item__viewBar"},r.a.createElement("div",{className:"stats__section__list__item__modelsList__item__viewBar__inner",style:{width:"".concat(a[t].models[e].favoritesCounter/c*100,"%")}})),r.a.createElement("div",{className:"stats__section__list__item__modelsList__item__viewCounter"},a[t].models[e].favoritesCounter))}))))})))),r.a.createElement("section",{className:"stats__section"},r.a.createElement(W,{title:"Top favorites"}),r.a.createElement("ul",{className:"stats__products__list"},o.map((function(t){return r.a.createElement(H,{id:t._id,mainImg:t.general.mainImgUrl,title:t.general.title,brand:t.general.brand,model:t.general.model,year:t.general.year,price:t.general.price,nbKilometers:t.general.nbKilometers,gazol:t.general.gazol,transmissionType:t.general.transmissionType,goToProd:function(){e.props.setProductRequestedId(t._id),e.props.history.push("/inventory/".concat(t._id))}})})))))),l}}]),t}(n.Component),Z=Object(_.f)(Q),X=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={showBrandsData:[]},a.showBrandsDataHandler=function(e){var t=[];t="show all"===e?Object.keys(a.props.productsStats):"hide all"===e?[]:a.state.showBrandsData.includes(e)?a.state.showBrandsData.filter((function(t){return t!==e})):[].concat(Object(v.a)(a.state.showBrandsData),[e]),a.setState({showBrandsData:t})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.state.showBrandsData,a=this.props.productsStats,s=this.props.maxProductViews,c=this.props.mostViewedProducts;return r.a.createElement(n.Fragment,null,r.a.createElement("section",{className:"stats__section"},r.a.createElement(W,{title:" Products views"},r.a.createElement("div",{className:"stats__section__title__cta"},r.a.createElement(A,{color:"primary",onClick:function(){return e.showBrandsDataHandler("show all")}},"Show"),r.a.createElement(A,{color:"primary",onClick:function(){return e.showBrandsDataHandler("hide all")}},"Hide"))),r.a.createElement("ul",{className:"stats__section__list"},Object.keys(a).map((function(n){return r.a.createElement("li",{className:"stats__section__list__item\n                                        ".concat(t.includes(n)?"showList":""),key:n},r.a.createElement("div",{className:"stats__section__list__item__brandContainer",onClick:function(){return e.showBrandsDataHandler(n)}},r.a.createElement("div",{className:"stats__section__list__item__brand"},n),r.a.createElement("div",{className:"stats__section__list__item__viewBar"},r.a.createElement("div",{className:"stats__section__list__item__viewBar__inner",style:{width:"".concat(a[n].views/s*100,"%")}})),r.a.createElement("div",{className:"stats__productViews__list__item__viewCounter"},a[n].views)),r.a.createElement("ul",{className:"stats__section__list__item__modelsList"},Object.keys(a[n].models).map((function(e){return r.a.createElement("li",{key:e,className:"stats__section__list__item__modelsList__item"},r.a.createElement("div",{className:"stats__section__list__item__modelsList__item__model"},e),r.a.createElement("div",{className:"stats__section__list__item__modelsList__item__viewBar"},r.a.createElement("div",{className:"stats__section__list__item__modelsList__item__viewBar__inner",style:{width:"".concat(a[n].models[e].viewCounter/s*100,"%")}})),r.a.createElement("div",{className:"stats__section__list__item__modelsList__item__viewCounter"},a[n].models[e].viewCounter))}))))})))),r.a.createElement("section",{className:"stats__section"},r.a.createElement(W,{title:"Top views"}),r.a.createElement("ul",{className:"stats__products__list"},c.map((function(t){return r.a.createElement(H,{id:t._id,mainImg:t.general.mainImgUrl,title:t.general.title,brand:t.general.brand,model:t.general.model,year:t.general.year,price:t.general.price,nbKilometers:t.general.nbKilometers,gazol:t.general.gazol,transmissionType:t.general.transmissionType,goToProd:function(){e.props.setProductRequestedId(t._id),e.props.history.push("/inventory/".concat(t._id))}})})))))}}]),t}(n.Component),$=Object(_.f)(X),ee=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={productsStats:null,maxProductViews:0,loading:!0,showBrandsData:[],activeSection:"products views",userConnectionStats:null,mostViewedProducts:null,mostFollowedProducts:null},a.fetchProductsStats=function(){fetch("https://africauto.herokuapp.com/stats/products-stats",{headers:{"Content-Type":"application/json"}}).then((function(e){if(200!==e.status)throw new Error("Failed to fetch users");return e.json()})).then((function(e){var t=0;Object.keys(e.stats).forEach((function(a){e.stats[a].views>t&&(t=e.stats[a].views)})),a.setState({productsStats:e.stats,mostViewedProducts:e.mostViewedProducts,mostFollowedProducts:e.mostFollowedProducts,maxProductViews:t,loading:!1})})).catch((function(e){console.log(e)}))},a.fetchUserConnectionStats=function(){fetch("https://africauto.herokuapp.com/stats/user-connection-stats",{headers:{"Content-Type":"application/json"}}).then((function(e){if(200!==e.status)throw new Error("Failed to fetch users connection stats");return e.json()})).then((function(e){var t=e.stats;a.setState({userConnectionStats:t,loading:!1})})).catch((function(e){console.log(e)}))},a.activSectionToggler=function(e){var t=a.state.userConnectionStats;"website loadings"===e&&!t||"connected users"===e&&!t?a.setState({loading:!0,activeSection:e},(function(){return a.fetchUserConnectionStats()})):a.setState({activeSection:e})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.fetchProductsStats()}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.maxProductViews,s=a.productsStats,c=a.loading,i=a.activeSection,o=a.userConnectionStats,l=a.mostViewedProducts,u=a.mostFollowedProducts;return c&&(e=r.a.createElement(h,null)),c||"products views"!==i||(e=r.a.createElement($,{productsStats:s,maxProductViews:n,setProductRequestedId:this.props.setProductRequestedId,mostViewedProducts:l})),c||"favorite products"!==i||(e=r.a.createElement(Z,{stats:s,mostFollowedProducts:u,setProductRequestedId:this.props.setProductRequestedId})),c||"website loadings"!==i||(e=r.a.createElement(K,{stats:o})),c||"connected users"!==i||(e=r.a.createElement(J,{stats:o})),r.a.createElement("div",{className:"stats"},r.a.createElement("nav",{className:"stats__nav"},r.a.createElement("ul",{className:"stats__nav__list"},r.a.createElement("li",{className:"stats__nav__list__item ".concat("products views"===i?"active":""),onClick:function(){return t.activSectionToggler("products views")}},"Products Views"),r.a.createElement("li",{className:"stats__nav__list__item ".concat("favorite products"===i?"active":""),onClick:function(){return t.activSectionToggler("favorite products")}},"Favorite Products"),r.a.createElement("li",{className:"stats__nav__list__item ".concat("website loadings"===i?"active":""),onClick:function(){return t.activSectionToggler("website loadings")}},"Website loadings"),r.a.createElement("li",{className:"stats__nav__list__item  ".concat("connected users"===i?"active":""),onClick:function(){return t.activSectionToggler("connected users")}},"Connected users"))),e)}}]),t}(n.Component),te=Object(p.b)(null,(function(e){return{setProductRequestedId:function(t){return e(O(t))}}}))(ee),ae=(a(256),a(39)),ne=a.n(ae),re=(a(258),a(116)),se=a.n(re),ce={general:{title:{valueType:"text",control:"input",label:"title",placeholder:"title",value:""},brand:{valueType:"text",control:"input",label:"brand",placeholder:"brand",value:""},model:{valueType:"text",control:"input",label:"model",placeholder:"model",value:""},year:{valueType:"text",control:"select",label:"year",placeholder:"year",value:"2008",options:["2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020"]},price:{valueType:"number",control:"input",label:"price",placeholder:"price",value:0},bodyType:{valueType:"text",control:"select",label:"body type",placeholder:"body type",value:"sedan",options:["sedan","coupe","hatchBack","SUV","crossover","minivan","pickup"]},nbKilometers:{valueType:"number",control:"input",label:"Nb km",placeholder:"kilometers",value:0},gazol:{valueType:"text",control:"select",label:"fuel",placeholder:"fuel",value:"essence",options:["essence","diesel"]},yearOfRelease:{valueType:"text",control:"select",label:"year of release",placeholder:"year of release",value:"2008",options:["2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020"]},nbOwners:{valueType:"number",control:"select",label:"nb owners",placeholder:"number of owners",value:0,options:[0,1,2,3,4,5,6]},serialNumber:{valueType:"text",control:"input",label:"serial number",placeholder:"serial number",value:""},generalState:{valueType:"text",control:"input",label:"general state",placeholder:"general state",value:""},publicity:{valueType:"number",control:"select",label:"publicity",placeholder:"true",value:"true",options:["true","false"]},homePage:{valueType:"number",control:"select",label:"home page",placeholder:"true",value:"true",options:["true","false"]}},supplier:{reference:{valueType:"text",control:"input",label:"reference",placeholder:"reference",value:""},supplierPrice:{valueType:"number",control:"input",label:"supplier price",placeholder:"supplier price",value:0},supplierName:{valueType:"text",control:"select",label:"supplier",placeholder:"supplier",value:"",options:[]}},tech:{transmissionType:{valueType:"text",control:"select",label:"gear box",placeholder:"gear box",value:"manual",options:["manual","automatic"]},nbGearRatios:{valueType:"number",control:"select",label:"gear box ratio",placeholder:"gear box ratio",value:5,options:[5,6]},nbCylinders:{valueType:"number",control:"select",label:"nb cylinders",placeholder:"nombre de cylinders",value:2,options:[2,3,4,5,6,7,8,9,10,11,12]},motorSize:{valueType:"text",control:"input",label:"motor size",placeholder:"motor size",value:""},maxSpeed:{valueType:"text",control:"input",label:"max speed",placeholder:"max speed",value:""}},design:{intColor:{valueType:"text",control:"input",label:"interior color",placeholder:"interior color",value:""},extColor:{valueType:"text",control:"input",label:"exterior color",placeholder:"exterior color",value:""}}},ie=(a(261),a(262),function(e){return r.a.createElement("div",{className:"input ".concat(e.className)},"input"===e.control&&r.a.createElement("input",{className:"input__field",type:e.type,id:e.id,required:e.required,value:e.value,placeholder:e.placeholder,autoComplete:e.autoComplete,onChange:function(t){return e.onChange(e.id,t.target.value,e.formType)}}),"textarea"===e.control&&r.a.createElement("textarea",{className:"textarea",id:e.id,required:e.required,value:e.value,onChange:function(t){return e.onChange(e.id,t.target.value)}}),"select"===e.control&&r.a.createElement("select",{id:e.id,required:e.required,onChange:function(t){return e.onChange(e.id,t.target.value)},value:e.value},e.options.map((function(e){return r.a.createElement("option",{key:e,value:e},e)}))),e.label&&r.a.createElement("label",{htmlFor:e.id,className:"input__label"},e.label),e.border&&r.a.createElement("div",{className:"input__border"}))}),oe=function(e){var t=e.featuresList;return r.a.createElement("div",{className:"formFeature"},r.a.createElement("div",{className:"formFeature__add"},r.a.createElement(ie,{className:"add-product__input",id:"options",placeholder:"ajouter options",control:"input",value:e.value,onChange:e.addFeatureChangeHandler}),r.a.createElement(A,{onClick:e.addFeature,color:"secondary"},"Add")),r.a.createElement("ul",{className:"formFeature__list"},t.map((function(t){return r.a.createElement("li",{className:"formFeature__list__item",key:t,onClick:function(){return e.deleteFeature(t)}},t)}))))},le=(a(263),a(55)),ue=a(117);a(265),a(266);Object(le.registerPlugin)(ue);var de=function(e){var t,a=e.productBeingEditedCurrentImages,n=e.selectedImages,s=e.cancelDeleteImagesAlowed;return t=!0===e.editingMode?r.a.createElement("div",null,r.a.createElement("h3",{className:"file-picker__title"},"New images"),r.a.createElement(le.FilePond,{className:"add-product__filepond",allowMultiple:!0,onupdatefiles:e.filesHandler})):r.a.createElement(le.FilePond,{className:"add-product__filepond",allowMultiple:!0,onupdatefiles:e.filesHandler}),r.a.createElement("div",{className:"file-picker"},!0===e.editingMode&&r.a.createElement("div",{className:"file-picker__currentImages"},r.a.createElement("h3",{className:"file-picker__title"},"Current images"),r.a.createElement("ul",{className:"file-picker__currentImages__list"},a.map((function(t){return r.a.createElement("div",{className:"file-picker__currentImages__list__item",onClick:function(){return e.selectDeleteHandler(t.url)}},!0===t.checked?r.a.createElement(D,{icon:"checked"}):null,r.a.createElement("img",{src:t.url,alt:"current images",className:"file-picker__currentImages__list__item__img",key:t.url}))}))),r.a.createElement("div",{className:"file-picker__currentImages__controller"},0!==n.length&&r.a.createElement(A,{onClick:e.onDeleteCurrentImages},"Delete"),!0===s&&0!==n.length&&r.a.createElement(A,{onClick:e.onCancelDeleteCurrentImages},"Cancel"))),t)},me=a(53),_e=a.n(me);a(322);_e.a.initializeApp({apiKey:"AIzaSyARcDQEFmrLLL8WHVxiPDf2Pw-JZ2pULPs",authDomain:"africauto-motors.firebaseapp.com",databaseURL:"https://africauto-motors.firebaseio.com",projectId:"africauto-motors",storageBucket:"africauto-motors.appspot.com",messagingSenderId:"325187327572",appId:"1:325187327572:web:a31ba21828ea63225ebfc1"});var pe=_e.a.storage(),he=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={images:[],urlImages:[],albumId:"",loading:!1,featuresList:[],featureBeingAdded:"",showImage:!1,productBeingEdited:{},productBeingEditedID:"",productBeingEditedCurrentUrlImages:[],productBeingEditedCurrentUrlImagesWithChekedOption:[],selectedImages:[],cancelImageDeletingAllowed:!1,initialForm:null,requestDataSet:null},a.preparesDataHandler=function(){var e=a.props.suppliers,t=[];e.forEach((function(e){t.push(e.name)}));var n={};Object.keys(ce).forEach((function(e){n=Object(g.a)({},n,Object(f.a)({},e,Object(g.a)({},ce[e])))}));var r={};if(Object.keys(n).forEach((function(e){Object.keys(n[e]).forEach((function(t){r=Object(g.a)({},r,Object(f.a)({},t,n[e][t].value))}))})),n.supplier.supplierName.options=t,!1===a.props.editingMode)return r.supplierName=t[0],a.setState({initialForm:n,requestDataSet:r,loading:!1});var s=a.props.productBeingEdited;console.log(s),Object.keys(s).forEach((function(e){Object.keys(s[e]).forEach((function(t){Object.keys(r).forEach((function(a){t===a&&(r=Object(g.a)({},r,Object(f.a)({},a,s[e][t])))}))}))})),r=Object(g.a)({},r,{price:s.general.price,supplierName:s.supplier.info.name});var c=[];s.imageUrls.forEach((function(e){c=[].concat(Object(v.a)(c),[{url:e,checked:!1}])})),console.log(r),a.setState({initialForm:n,requestDataSet:r,albumId:s.albumId,productBeingEditedCurrentUrlImages:s.imageUrls,productBeingEditedID:s._id,featuresList:s.features,productBeingEditedCurrentUrlImagesWithChekedOption:c,loading:!1})},a.inputChangeHandler=function(e,t){a.setState((function(a){return Object(g.a)({},a,{requestDataSet:Object(g.a)({},a.requestDataSet,Object(f.a)({},e,t))})}))},a.senData=function(){var e,t,n=a.state,r=n.featuresList,s=n.urlImages,c=n.requestDataSet,i=n.images,o=n.selectedImages,l=a.props.suppliers,u=c.supplierName,d=l.find((function(e){return e.name===u}))._id,m=new FormData;if(!1===a.props.editingMode&&(Object.keys(c).map((function(e){return m.append("".concat(e),"".concat(c[e]))})),m.append("features",r),m.append("imageUrls",s),m.append("albumId",a.state.albumId),m.append("supplierId",d),e="POST",t="https://africauto.herokuapp.com/admin/add-product"),!0===a.props.editingMode){var _=[];0===i.length&&0===o.length?_=a.state.productBeingEditedCurrentUrlImages:(0!==i.length&&0===o.length&&(_=[].concat(Object(v.a)(a.state.productBeingEditedCurrentUrlImages),Object(v.a)(a.state.urlImages))),0===i.length&&0!==o.length&&(_=a.state.productBeingEditedCurrentUrlImages.filter((function(e){return!o.includes(e)}))),0!==i.length&&0!==o.length&&(_=[].concat(Object(v.a)(a.state.productBeingEditedCurrentUrlImages),Object(v.a)(a.state.urlImages)).filter((function(e){return!a.state.selectedImages.includes(e)})))),Object.keys(c).map((function(e){return m.append("".concat(e),"".concat(c[e]))})),m.append("features",r),m.append("albumId",a.state.albumId),m.append("imageUrls",_),m.append("productBeingEditedID",a.state.productBeingEditedID),m.append("supplierId",d),e="PUT",t="https://africauto.herokuapp.com/admin/edit-product"}fetch(t,{headers:{"Content-Type":"application/json"},method:e,body:JSON.stringify(Object.fromEntries(m))}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Creating a product failed");return e.json()})).then((function(e){return a.props.setProductRequested(e.product),a.props.setProductRequestedId(e.product._id),a.props.addTotalProducts(),e})).then((function(e){!0===a.props.editingMode?(a.props.toggleEditingMode(),a.props.history.push("/inventory/".concat(a.props.productBeingEditedId,"?brand=").concat(e.product.brand,"&model=").concat(e.product.model,"&price=").concat(e.product.price))):a.props.history.push("/inventory/".concat(e.product._id,"?brand=").concat(e.product.brand,"&model=").concat(e.product.model,"&price=").concat(e.product.price))})).catch((function(e){a.setState({loading:!1}),console.log(e)}))},a.uploadHandler=function(e){var t,n,r;return ne.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(e.preventDefault(),a.setState({loading:!0}),t=a.state.images,!0===a.props.editingMode?n=a.state.albumId:(n=se()(),a.setState({albumId:n})),0===t.length){s.next=20;break}return s.prev=5,s.next=8,ne.a.awrap(Promise.all(t.map((function(e){return new Promise((function(t,r){pe.ref("".concat(n,"--").concat(e.name)).put(e).on("state_changed",(function(e){}),r,(function(){pe.ref("".concat(n,"--").concat(e.name)).getDownloadURL().then((function(e){var n=a.state.urlImages;n.push(e),a.setState({urlImages:n}),t(e)}))}))}))}))));case 8:return r=s.sent,0===a.state.selectedImages.length&&a.senData(),0!==a.state.selectedImages.length&&a.deleteImagesInFirebase(),s.abrupt("return",r);case 14:s.prev=14,s.t0=s.catch(5),a.setState({loading:!1}),console.log(s.t0);case 18:s.next=21;break;case 20:0!==a.state.selectedImages?a.deleteImagesInFirebase():a.senData();case 21:case"end":return s.stop()}}),null,null,[[5,14]])},a.deleteImagesInFirebase=function(){var e,t,n,r;return ne.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return e=a.state,t=e.selectedImages,n=e.albumId,s.prev=1,s.next=4,ne.a.awrap(Promise.all(t.map((function(e){return new Promise((function(t,a){var r=e.indexOf("--"),s=e.indexOf("?"),c=e.substr(r+2,s-r-2);pe.ref("".concat(n,"--").concat(c)).delete().then((function(){return t(e)})).catch((function(e){return a}))}))}))));case 4:return r=s.sent,a.senData(),s.abrupt("return",r);case 9:s.prev=9,s.t0=s.catch(1),a.setState({loading:!1}),console.log(s.t0);case 13:case"end":return s.stop()}}),null,null,[[1,9]])},a.filesHandler=function(e){var t=[];e.forEach((function(e){var a=e.file;t=[].concat(Object(v.a)(t),[a])})),a.setState({images:t})},a.showImageFormHandler=function(e){e.preventDefault(),window.scrollTo(0,0),!1===a.state.showImage&&a.setState({showImage:!0})},a.hideImageFormHandler=function(e){e.preventDefault(),window.scrollTo(0,0),!0===a.state.showImage&&a.setState({showImage:!1})},a.addFeatureChangeHandler=function(e,t){a.setState({featureBeingAdded:t})},a.addFeature=function(e){e.preventDefault();var t=a.state,n=t.featureBeingAdded,r=t.featuresList,s=[].concat(Object(v.a)(r),[n]);a.setState({featuresList:s})},a.deleteFeature=function(e){var t=a.state.featuresList.filter((function(t){return t!==e}));a.setState({featuresList:t})},a.selectDeleteHandler=function(e){var t=a.state.productBeingEditedCurrentUrlImagesWithChekedOption,n=a.state.selectedImages;n=0!==n.length&&n.includes(e)?n.filter((function(t){return t!==e})):[].concat(Object(v.a)(n),[e]);var r=[];t.forEach((function(t){r=t.url===e?!1===t.checked?[].concat(Object(v.a)(r),[{url:t.url,checked:!0}]):[].concat(Object(v.a)(r),[{url:t.url,checked:!1}]):[].concat(Object(v.a)(r),[t])})),a.setState({productBeingEditedCurrentUrlImagesWithChekedOption:r,selectedImages:n})},a.deleteImageOnThePage=function(e){e.preventDefault();var t=a.state.productBeingEditedCurrentUrlImagesWithChekedOption.filter((function(e){return!0!==e.checked}));a.setState({productBeingEditedCurrentUrlImagesWithChekedOption:t,cancelImageDeletingAllowed:!0})},a.cancelDeleteCurrentImageHandler=function(e){e.preventDefault();var t=a.state,n=t.selectedImages,r=t.productBeingEditedCurrentUrlImagesWithChekedOption,s=[];n.forEach((function(e){s=[].concat(Object(v.a)(s),[{url:e,checked:!0}])}));var c=[].concat(Object(v.a)(r),Object(v.a)(s));a.setState({productBeingEditedCurrentUrlImagesWithChekedOption:c,cancelImageDeletingAllowed:!1})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.preparesDataHandler()}},{key:"componentWillUnmount",value:function(){console.log(["UNMOUNTED"]),!0===this.props.editingMode&&(this.props.toggleEditingMode(),this.props.setProductRequestedId(""),this.props.setProductRequested({}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.initialForm,n=t.requestDataSet;return!0===this.state.loading||null===a||null===n?r.a.createElement(h,null):r.a.createElement("section",{className:"add-product"},r.a.createElement("form",{className:"add-product__form"},!0!==this.state.showImage&&r.a.createElement("div",{className:"add-product__part add-product__part--details "},Object.keys(a).map((function(t){return r.a.createElement("div",{className:"add-product__part--details__section",key:t},r.a.createElement("h3",{className:"add-product__form__title"},t),Object.keys(a[t]).map((function(s){var c=a[t][s];return r.a.createElement(ie,{className:"add-product__input",label:c.label,key:c.label,id:s,options:c.options,placeholder:c.placeholder,control:c.control,type:c.type,value:n[s],onChange:e.inputChangeHandler})})))})),r.a.createElement("div",{className:"add-product__part--details__section"},r.a.createElement("h3",{className:"add-product__form__title"},"options"),r.a.createElement(oe,{featuresList:this.state.featuresList,addFeatureChangeHandler:this.addFeatureChangeHandler,value:this.state.featureBeingAdded,addFeature:this.addFeature,deleteFeature:this.deleteFeature})),r.a.createElement("div",{className:"add-product__form__controller"},r.a.createElement(A,{onClick:this.showImageFormHandler,color:"primary"},"next"))),!0===this.state.showImage&&r.a.createElement("div",{className:"add-product__part add-product__part--image "},r.a.createElement("h3",{className:"add-product__form__title"},"Images"),r.a.createElement(de,{filesHandler:this.filesHandler,productBeingEditedCurrentImages:this.state.productBeingEditedCurrentUrlImagesWithChekedOption,editingMode:this.props.editingMode,selectDeleteHandler:this.selectDeleteHandler,selectedImages:this.state.selectedImages,onDeleteCurrentImages:this.deleteImageOnThePage,cancelDeleteImagesAlowed:this.state.cancelImageDeletingAllowed,onCancelDeleteCurrentImages:this.cancelDeleteCurrentImageHandler}),r.a.createElement("div",{className:"add-product__form__controller"},r.a.createElement(A,{onClick:this.hideImageFormHandler},"previous"),r.a.createElement(A,{onClick:this.uploadHandler},"upload"),r.a.createElement(A,{onClick:this.over},"State")))))}}]),t}(n.Component),fe=Object(p.b)((function(e){return{editingMode:e.products.editingMode,productBeingEdited:e.products.productRequested,productBeingEditedId:e.products.productRequestedId,suppliers:e.suppliers.suppliers}}),(function(e){return{toggleEditingMode:function(){return e({type:"TOGGLE_EDITING_MODE"})},setProductRequested:function(t){return e(C(t))},setProductRequestedId:function(t){return e(O(t))},setSuppliers:function(t){return e(I(t))},addTotalProducts:function(){return e({type:"ADD_TOTAL_PRODUCTS"})}}}))(he),ge=a(31),ve=(a(269),a(325)),Ee=(a(270),function(e){var t=e.product;return r.a.createElement("div",{className:"overview"},r.a.createElement("section",{className:"overview__section"},r.a.createElement("div",{className:"overview__title"},r.a.createElement(D,{icon:"file"}),r.a.createElement("div",null,"General")),r.a.createElement("ul",{className:"overview__list"},r.a.createElement("li",{className:"overview__list__item"},r.a.createElement("div",{className:"overview__list__item__key"},"Brand"),r.a.createElement("div",{className:"overview__list__item__value"},t.general.brand)),r.a.createElement("li",{className:"overview__list__item"},r.a.createElement("div",{className:"overview__list__item__key"},"Model"),r.a.createElement("div",{className:"overview__list__item__value"},t.general.model)),r.a.createElement("li",{className:"overview__list__item"},r.a.createElement("div",{className:"overview__list__item__key"},"Body Type"),r.a.createElement("div",{className:"overview__list__item__value"},t.general.bodyType)),r.a.createElement("li",{className:"overview__list__item"},r.a.createElement("div",{className:"overview__list__item__key"},"Year"),r.a.createElement("div",{className:"overview__list__item__value"},t.general.year)),r.a.createElement("li",{className:"overview__list__item"},r.a.createElement("div",{className:"overview__list__item__key"},"Kilometer"),r.a.createElement("div",{className:"overview__list__item__value"},t.general.nbKilometers.toLocaleString()," km")),r.a.createElement("li",{className:"overview__list__item"},r.a.createElement("div",{className:"overview__list__item__key"},"Year of release"),r.a.createElement("div",{className:"overview__list__item__value"},t.general.yearOfRelease)),r.a.createElement("li",{className:"overview__list__item"},r.a.createElement("div",{className:"overview__list__item__key"},"Serial number"),r.a.createElement("div",{className:"overview__list__item__value"},t.general.serialNumber)))),r.a.createElement("section",{className:"overview__section"},r.a.createElement("div",{className:"overview__title"},r.a.createElement(D,{icon:"design"}),r.a.createElement("div",null,"Design")),r.a.createElement("ul",{className:"overview__list"},r.a.createElement("li",{className:"overview__list__item"},r.a.createElement("div",{className:"overview__list__item__key"},"Interior color"),r.a.createElement("div",{className:"overview__list__item__value"},t.design.intColor)),r.a.createElement("li",{className:"overview__list__item"},r.a.createElement("div",{className:"overview__list__item__key"},"Exterior color"),r.a.createElement("div",{className:"overview__list__item__value"},t.design.extColor)))))}),be=(a(271),function(e){var t=e.product;return r.a.createElement("div",{className:"technical"},r.a.createElement("div",{className:"technical__section"},r.a.createElement("div",{className:"technical__title"},r.a.createElement(D,{icon:"engine"}),r.a.createElement("div",null,"Engine")),r.a.createElement("ul",{className:"technical__section__list"},r.a.createElement("li",{className:"technical__section__list__item"},r.a.createElement("span",{className:"technical__section__list__item__detail"},"Motor size"),r.a.createElement("span",{className:"technical__section__list__item__value"},t.tech.motorSize)),r.a.createElement("li",{className:"technical__section__list__item"},r.a.createElement("span",{className:"technical__section__list__item__detail"},"Number of cylinders"),r.a.createElement("span",{className:"technical__section__list__item__value"},t.tech.nbCylinders)),r.a.createElement("li",{className:"technical__section__list__item"},r.a.createElement("span",{className:"technical__section__list__item__detail"},"Fuel"),r.a.createElement("span",{className:"technical__section__list__item__value"},t.general.gazol)),r.a.createElement("li",{className:"technical__section__list__item"},r.a.createElement("span",{className:"technical__section__list__item__detail"},"Max speed"),r.a.createElement("span",{className:"technical__section__list__item__value"},t.tech.maxSpeed," km/h")))),r.a.createElement("div",{className:"technical__section"},r.a.createElement("div",{className:"technical__title"},r.a.createElement(D,{icon:"gear"}),r.a.createElement("div",null,"Transmission")),r.a.createElement("ul",{className:"technical__section__list"},r.a.createElement("li",{className:"technical__section__list__item"},r.a.createElement("span",{className:"technical__section__list__item__detail"},"Gear box"),r.a.createElement("span",{className:"technical__section__list__item__value"},t.general.transmissionType)),r.a.createElement("li",{className:"technical__section__list__item"},r.a.createElement("span",{className:"technical__section__list__item__detail"},"Number of gear ratios"),r.a.createElement("span",{className:"technical__section__list__item__value"},t.tech.nbGearRatios)))))}),ye=(a(272),function(e){var t=e.product;return r.a.createElement("div",{className:"features"},r.a.createElement("ul",{className:"features__list"},t.features.map((function(e){return r.a.createElement("li",{className:"features__list__item"},r.a.createElement(D,{icon:"arrow-list"}),e)}))))}),Ne=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).imageSlideHandler=function(){var e=a.state,t=e.index,n=e.images,r=e.initiatlIndex;a.inter=setInterval((function(){t===n.length?a.setState({index:r},(function(){clearInterval(a.inter),a.imageSlideHandler()})):a.setState({index:t++})}),2500)},a.changeGalleryImgIndex=function(e){var t=a.state.product.imageUrls.indexOf("".concat(e));a.setState({index:t})},a.detailRequestHandler=function(e){a.setState({requestedSection:e})},a.state={index:0,initiatlIndex:0,product:null,loading:!0,partRequested:"overview"},a.escFunction=a.escFunction.bind(Object(ge.a)(a)),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e,t=this;e=""===this.props.prodId?this.props.match.params.prodId:this.props.prodId;fetch("https://africauto.herokuapp.com/admin/"+e,{headers:{"Content-type":"application/json"},method:"GET"}).then((function(e){if(200!==e.status)throw new Error("Failed to fetch that product");return e.json()})).then((function(e){t.setState({product:e.product,loading:!1},(function(){return t.props.setProductRequested(e.product)}))})).catch((function(e){console.log(e)})),document.addEventListener("keydown",this.escFunction,!1)}},{key:"componentWillUnmount",value:function(){clearInterval(this.inter),document.removeEventListener("keydown",this.escFunction,!1)}},{key:"escFunction",value:function(e){27===e.keyCode&&this.props.hideScrollBar&&this.props.showScrollBarHandler()}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.partRequested,s=a.product,c=a.loading;return"overview"===n&&(e=r.a.createElement(Ee,{product:s})),"technical"===n&&(e=r.a.createElement(be,{product:s})),"features"===n&&(e=r.a.createElement(ye,{product:s})),!0===c?r.a.createElement("div",null,"loading"):r.a.createElement("div",{className:"single-car"},r.a.createElement("div",{className:"single-car__backBtn",onClick:function(){return t.props.history.goBack()}},"Back"),r.a.createElement("div",{className:"single-car__header"},r.a.createElement("div",{className:"single-car__header__main"},r.a.createElement("div",{className:"single-car__header__main__titleContainer"},r.a.createElement("h1",{className:"single-car__header__main__title"},s.general.title," ",s.general.year),r.a.createElement("div",{className:"single-car__header__main__controller"},r.a.createElement(A,{link:{pathname:"/ajouter"},color:"primary",onClick:this.props.toggleEditingMode},"Edit"),r.a.createElement(A,{link:"/",color:"primary"},"Delete"))),r.a.createElement("div",{className:"single-car__header__main__gallery"},r.a.createElement(ve.a,{index:this.state.index,onRequestChange:function(e){return t.setState({index:e})}},s.imageUrls.map((function(e){return r.a.createElement(ve.b,{objectFit:"cover",key:e,src:e,onClick:t.props.hideScrollBarHandler})})))),this.props.hideScrollBar&&r.a.createElement("div",{className:"single-car__header__main__gallery--fullContainer"},r.a.createElement("div",{className:"single-car__header__main__gallery--fullContainer__closeBtn",onClick:this.props.showScrollBarHandler},r.a.createElement(D,{icon:"close"})),r.a.createElement("div",{className:"single-car__header__main__gallery--full"},r.a.createElement(ve.a,{index:this.state.index,onRequestChange:function(e){return t.setState({index:e})}},s.imageUrls.map((function(e){return r.a.createElement(ve.b,{objectFit:"contain",key:e,src:e})}))))),r.a.createElement("div",{className:"single-car__header__main__gallery__controller"},s.imageUrls.map((function(e){return r.a.createElement("img",{src:e,alt:"car",className:"single-car__header__main__gallery__controller__img",key:e,onClick:function(){return t.changeGalleryImgIndex(e)}})})))),r.a.createElement("div",{className:"single-car__header__info"},r.a.createElement("div",{className:"single-car__header__info__priceContainer"},r.a.createElement("div",{className:"single-car__header__info__price"},s.general.price.toLocaleString()," CAD")),r.a.createElement("ul",{className:"single-car__header__info__list"},r.a.createElement("li",{className:"single-car__header__info__list__item"},r.a.createElement("div",{className:"single-car__header__info__list__item__key"},"reference"),r.a.createElement("div",{className:"single-car__header__info__list__item__value"},s.supplier.reference)),r.a.createElement("li",{className:"single-car__header__info__list__item"},r.a.createElement("div",{className:"single-car__header__info__list__item__key"},"brand"),r.a.createElement("div",{className:"single-car__header__info__list__item__value"},s.general.brand)),r.a.createElement("li",{className:"single-car__header__info__list__item"},r.a.createElement("div",{className:"single-car__header__info__list__item__key"},"body type"),r.a.createElement("div",{className:"single-car__header__info__list__item__value"},s.general.bodyType)),r.a.createElement("li",{className:"single-car__header__info__list__item"},r.a.createElement("div",{className:"single-car__header__info__list__item__key"},"model"),r.a.createElement("div",{className:"single-car__header__info__list__item__value"},s.general.model)),r.a.createElement("li",{className:"single-car__header__info__list__item"},r.a.createElement("div",{className:"single-car__header__info__list__item__key"},"year"),r.a.createElement("div",{className:"single-car__header__info__list__item__value"},s.general.year)),r.a.createElement("li",{className:"single-car__header__info__list__item"},r.a.createElement("div",{className:"single-car__header__info__list__item__key"},"kilometer"),r.a.createElement("div",{className:"single-car__header__info__list__item__value"},s.general.nbKilometers," km")),r.a.createElement("li",{className:"single-car__header__info__list__item"},r.a.createElement("div",{className:"single-car__header__info__list__item__key"},"YOR"),r.a.createElement("div",{className:"single-car__header__info__list__item__value"},s.general.yearOfRelease)),r.a.createElement("li",{className:"single-car__header__info__list__item"},r.a.createElement("div",{className:"single-car__header__info__list__item__key"},"fuel"),r.a.createElement("div",{className:"single-car__header__info__list__item__value"},s.general.gazol)),r.a.createElement("li",{className:"single-car__header__info__list__item"},r.a.createElement("div",{className:"single-car__header__info__list__item__key"},"gear box"),r.a.createElement("div",{className:"single-car__header__info__list__item__value"},s.general.transmissionType)),r.a.createElement("li",{className:"single-car__header__info__list__item"},r.a.createElement("div",{className:"single-car__header__info__list__item__key"},"serial number"),r.a.createElement("div",{className:"single-car__header__info__list__item__value"},s.general.serialNumber)),r.a.createElement("li",{className:"single-car__header__info__list__item"},r.a.createElement("div",{className:"single-car__header__info__list__item__key"},"views"),r.a.createElement("div",{className:"single-car__header__info__list__item__value"},s.general.viewCounter?s.general.viewCounter:"-")),r.a.createElement("li",{className:"single-car__header__info__list__item"},r.a.createElement("div",{className:"single-car__header__info__list__item__key"},"followers"),r.a.createElement("div",{className:"single-car__header__info__list__item__value"},s.followersCounter?s.followersCounter:"-"))))),r.a.createElement("section",{className:"single-car__details"},r.a.createElement("ul",{className:"single-car__details__nav"},r.a.createElement("li",{className:"single-car__details__nav__item\n                                        ".concat("overview"===this.state.partRequested?"active":""),onClick:function(){return t.setState({partRequested:"overview"})}},"Overview"),r.a.createElement("li",{className:"single-car__details__nav__item\n                                        ".concat("technical"===this.state.partRequested?"active":""),onClick:function(){return t.setState({partRequested:"technical"})}},"Technical"),r.a.createElement("li",{className:"single-car__details__nav__item\n                                        ".concat("features"===this.state.partRequested?"active":""),onClick:function(){return t.setState({partRequested:"features"})}},"Features")),e))}}]),t}(n.Component),Pe=Object(p.b)((function(e){return{prodId:e.products.productRequestedId}}),(function(e){return{setProductRequested:function(t){return e(C(t))},toggleEditingMode:function(){return e({type:"TOGGLE_EDITING_MODE"})}}}))(Ne),Se=(a(276),a(277),function(e){var t=[],a=Object.keys(e);return a.forEach((function(a){e[a].value.trim().length<1&&t.push("".concat(a," is required"))})),t.length>0?t:(/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(e.email.value.trim())||t.push("Please, enter a valid email"),a.includes("password")&&e.password.value.trim().length<5&&t.push("Password should be at least 5 characters long"),t)}),we=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={loginForm:{email:{value:""},password:{value:""}}},a.inputChangeHandler=function(e,t){a.setState((function(a){return{loginForm:Object(g.a)({},a.loginForm,Object(f.a)({},e,Object(g.a)({},a.loginForm[e],{value:t})))}}))},a.loginHandler=function(e,t){if(e.preventDefault(),a.props.setLoadingToTrue(),a.props.setError(null),t){var n=Se(t);if(n.length>0)return a.props.setError(n),void a.props.setLoadingToFalse()}fetch("https://africauto.herokuapp.com/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t.email.value,password:t.password.value})}).then((function(e){if(console.log("reeees"),422===e.status)throw new Error("validation failed");if(401===e.status)throw new Error("Wrong email or password");if(200!==e.status&&201!==e.status)throw new Error("Could not authenticate you");return e.json()})).then((function(e){a.props.loginSucceeded(e),localStorage.setItem("woto-admin-token",e.token),localStorage.setItem("woto-admin-adminId",e.userId),localStorage.setItem("woto-admin-adminName",e.adminName);var t=new Date((new Date).getTime()+36e5);localStorage.setItem("woto-admin-expiryData",t.toISOString()),a.props.setLoadingToFalse()})).catch((function(e){a.props.setError(e),a.props.loginFailed(),a.props.setLoadingToFalse()}))},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("form",{className:"auth__form auth__form--login",onSubmit:function(t){return e.loginHandler(t,e.state.loginForm)},noValidate:!0,autoComplete:"off"},r.a.createElement("ul",{className:"auth__input__list"},r.a.createElement(ie,{type:"email",control:"input",label:"email",id:"email",value:this.state.loginForm.email.value,onChange:this.inputChangeHandler,placeholder:"email",border:!0,required:!0}),r.a.createElement(ie,{type:"password",control:"input",label:"mot de passe",id:"password",value:this.state.loginForm.password.value,onChange:this.inputChangeHandler,placeholder:"mot de passe",border:!0,required:!0,autoComplete:"new-password"})),r.a.createElement("div",{className:"auth__button"},r.a.createElement(A,{color:"primary",type:"submit"},"Login")))}}]),t}(n.Component),Ce=Object(p.b)(null,(function(e){return{loginSucceeded:function(t){return e(function(e){return{type:"LOGIN_SUCCEDED",token:e.token,adminId:e.adminId,adminName:e.adminName}}(t))},loginFailed:function(){return e({type:"LOGIN_FAILED"})},setError:function(t){return e(j(t))}}}))(we),Oe=(a(278),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).closeErrorHandler=function(){a.props.setError(null)},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){setTimeout(this.closeErrorHandler,8e3)}},{key:"render",value:function(){var e=this,t=null;return this.props.errors&&(t=r.a.createElement("div",{className:"error"},r.a.createElement("div",{className:"error__header"},r.a.createElement("span",null,"Something went wrong"),r.a.createElement(D,{icon:"error"})),this.props.errors&&this.props.errors.map((function(e,t){return r.a.createElement("div",{key:t,className:"error__text"},e)})),r.a.createElement("div",{className:"error__cta"},r.a.createElement(A,{color:"primary",onClick:function(){return e.closeErrorHandler()}},"OK")))),t}}]),t}(n.Component)),Ie=Object(p.b)((function(e){return{errors:e.error.errors}}),(function(e){return{setError:function(t){return e(j(t))}}}))(Oe),je=(n.Component,function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!1,error:!1},a.setLoadingToTrue=function(){a.setState({loading:!0})},a.setLoadingToFalse=function(){a.setState({loading:!1})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("section",{className:"auth"},r.a.createElement("div",{className:"auth__container"},r.a.createElement("div",{className:"auth__controller"},r.a.createElement("div",{className:"auth__controller__button "},"Login")),r.a.createElement(Ce,{setLoadingToTrue:this.setLoadingToTrue,setLoadingToFalse:this.setLoadingToFalse})))}}]),t}(n.Component)),ke=(a(279),a(25)),Te=a.n(ke),De=(a(311),function(){return r.a.createElement("div",{className:"lds-ring"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null))}),He=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={users:[],searchedUser:"",searchedUserResults:[],searchedUserNoResults:!1,searchingUser:!1,query:{status:"all"},displaySelector:!1},a.fetchUsersdata=function(){fetch("https://africauto.herokuapp.com/admin/users",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({status:a.state.query.status})}).then((function(e){if(200!==e.status)throw new Error("Failed to fetch users");return e.json()})).then((function(e){a.setState({users:e.users})})).catch((function(e){console.log(e)}))},a.searchUserHandler=function(e){clearTimeout(a.timer),a.setState({searchedUser:e,searchedUserNoResults:!1}),a.timer=setTimeout((function(){return a.fetchSearchedUsers()}),1e3)},a.fetchSearchedUsers=function(){""!==a.state.searchedUser?(a.setState({searchingUser:!0}),fetch("https://africauto.herokuapp.com/user/search-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({search:a.state.searchedUser})}).then((function(e){if(422===e.status)throw new Error("Make sure the email isn't used yet");if(200!==e.status&&201!==e.status)throw new Error(" Creating a user failed");return e.json()})).then((function(e){e.users.length>0?a.setState({searchedUserResults:e.users,searchingUser:!1}):a.setState({searchedUserResults:e.users,searchingUser:!1,searchedUserNoResults:!0})})).catch((function(e){console.log(e)}))):a.setState({searchedUserResults:[],searchedUserNoResults:!1})},a.queryHandler=function(e){a.setState((function(t){return Object(g.a)({},t,{query:Object(g.a)({},t.query,{status:e})})}),(function(){return a.fetchUsersdata()}))},a.toggleDisplaySelector=function(){a.setState((function(e){return Object(g.a)({},e,{displaySelector:!e.displaySelector})}))},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.timer=null}},{key:"componentWillUnmount",value:function(){this.timer=null}},{key:"componentDidMount",value:function(){var e=this;this.fetchUsersdata();var t=Te()("https://africauto.herokuapp.com");t.on("userLoggedIn",(function(t){var a=t._id,n=e.state.users.find((function(e){return e._id===a}));n.active=!0,n.connection=[t.connection[t.connection.length-1]];var r=e.state.users.filter((function(e){return e._id!==a})),s=[];0===r.length?(s=[n],e.setState({users:s})):(s=[n].concat(Object(v.a)(r)),e.setState({users:s}))})),t.on("userLoggedOut",(function(t){var a=t._id,n=e.state.users.findIndex((function(e){return e._id===a})),r=e.state.users.find((function(e){return e._id===a}));r.active=!1,r.connection=[t.connection[t.connection.length-1]];var s=Object(v.a)(e.state.users);s[n]=r,e.setState({users:s})}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.users,n=t.searchedUser,s=t.searchedUserResults,c=t.searchedUserNoResults,i=t.searchingUser,o=t.query,l=(t.displaySelector,r.a.createElement(D,{icon:"search"}));return i&&(l=r.a.createElement(De,null)),r.a.createElement("section",{className:"users"},r.a.createElement("div",{className:"users__search"},r.a.createElement("div",{className:"users__search__inputContainer"},r.a.createElement("input",{className:"users__search__input",type:"text",value:n,placeholder:"Name Filter",onChange:function(t){return e.searchUserHandler(t.target.value)}}),l),r.a.createElement(y,{value:o.status,list:["all","active","away"],selectItemHandler:this.queryHandler}),!c&&s.length>0&&r.a.createElement("ul",{className:"users__search__results"},s.map((function(e){return r.a.createElement("li",{className:"users__search__results__item"},r.a.createElement("div",{className:"users__search__results__item__avatar"},e.firstName.slice(0,1),e.lastName.slice(0,1)),r.a.createElement("div",{className:"users__search__results__item__name"},e.firstName," ",e.lastName))}))),c&&r.a.createElement("ul",{className:"users__search__results"},r.a.createElement("li",{className:"users__search__results__item users__search__results__item--noResult"},"No user found"))),r.a.createElement("table",{className:"users__table"},r.a.createElement("thead",{className:"users__table__header "},r.a.createElement("tr",null,r.a.createElement("th",null,"\xa0"),r.a.createElement("th",null,"Identity"),r.a.createElement("th",null,"Email"),r.a.createElement("th",null,"T\xe9l"),r.a.createElement("th",null,"Status"),r.a.createElement("th",null,"Connection"),r.a.createElement("th",null,"Fiche"),r.a.createElement("th",null,"Open conversation"))),r.a.createElement("tbody",null,a.map((function(t){return r.a.createElement("tr",{className:"users__table__data",key:t._id},r.a.createElement("td",{className:"users__table__data__avatar"},r.a.createElement("div",null,t.firstName.slice(0,1),t.lastName.slice(0,1))),r.a.createElement("td",{className:"users__table__data__name"},t.firstName," ",t.lastName),r.a.createElement("td",{className:"users__table__data__info"},r.a.createElement("div",null,t.email)),r.a.createElement("td",{className:"users__table__data__info"},r.a.createElement("div",null,t.phoneNumber?t.phoneNumber:"N.D.")),r.a.createElement("td",{className:"users__table__data__status"},r.a.createElement("div",{className:"users__table__data__status__icon \n                                        ".concat(!0===t.active?"active":"")},!0===t.active?"active":"away")),r.a.createElement("td",{className:"users__table__data__info"},r.a.createElement("div",null,!0===t.active?t.connection[0].start:t.connection[0]?t.connection[0].end:"N.D.")),r.a.createElement("td",{className:"users__table__data__icon users__table__data__icon--file"},r.a.createElement(D,{icon:"file",onClick:function(){return e.props.history.push("/users/".concat(t._id))}})),r.a.createElement("td",{className:"users__table__data__icon users__table__data__icon--message"},r.a.createElement(D,{icon:"email"})))})))))}}]),t}(n.Component),Ue=(a(312),a(313),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={messages:[],requestedMessageUserId:""},a.checkIfAdminIsOnTheConvoToBeUpdated=function(e,t){var n=e===a.state.requestedMessageUserId,r=t,s=a.state.messages.filter((function(t){return t._id!==e}));n&&(r.messages[0].read=!0),a.setState({messages:[r].concat(Object(v.a)(s))},(function(){return console.log(a.state.messages)}))},a.onChangeConvoHandler=function(e){var t=a.state.messages.filter((function(t){return t._id===e}))[0],n=a.state.messages.findIndex((function(t){return t._id===e}));if(t.messages.length>0){t.messages[0].read=!0;var r=Object(v.a)(a.state.messages);r[n]=t,a.setState({requestedMessageUserId:e,messages:r})}else a.setState({requestedMessageUserId:e});a.props.onchangeConvoHandler(e)},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){e.messages[0]._id!==this.props.messages[0]._id&&this.setState({messages:this.props.messages})}},{key:"componentWillUnmount",value:function(){this._ismounted=!1}},{key:"componentDidMount",value:function(){var e=this;this._ismounted=!0,this.setState({messages:this.props.messages,requestedMessageUserId:this.props.requestedMessageUserId}),Te()("https://africauto.herokuapp.com").on("userSentMessage",(function(t){if(!0===e._ismounted){var a=t.messageData,n=a.userId,r=e.state.messages.filter((function(e){return e._id===n}))[0];r.messages[0]=a,e.checkIfAdminIsOnTheConvoToBeUpdated(n,r)}}))}},{key:"render",value:function(){var e=this,t=this.state.messages;return r.a.createElement("nav",{className:"messagesNavbar"},r.a.createElement("ul",{className:"messagesNavbar__list"},t&&t.map((function(t){return t.messages.length>0?r.a.createElement("li",{className:"messagesNavbar__list__item\n                                                ".concat(e.state.requestedMessageUserId===t._id?"active":"","\n                                                ").concat(!0===t.messages[0].read||"admin"===t.messages[0].senderType?"":"not-read","   \n                                    "),key:t._id,onClick:function(){return e.onChangeConvoHandler(t._id)}},r.a.createElement("div",{className:"messagesNavbar__list__item__avatar"},"".concat(t.firstName.slice(0,1)).concat(t.lastName.slice(0,1))),r.a.createElement("div",{className:"messagesNavbar__list__item__message"},r.a.createElement("div",{className:"messagesNavbar__list__item__message__name"},"".concat(t.firstName," ").concat(t.lastName)),"admin"===t.messages[0].senderType&&r.a.createElement("span",null,"admin: ",t.messages[0].message.slice(0,25),"..."),"user"===t.messages[0].senderType&&r.a.createElement("span",null,t.messages[0].message.slice(0,25),"..."))):r.a.createElement("li",{className:"messagesNavbar__list__item\n                                                ".concat(e.state.requestedMessageUserId===t._id?"active":""),key:t._id,onClick:function(){return e.onChangeConvoHandler(t._id)}},r.a.createElement("div",{className:"messagesNavbar__list__item__avatar"},"".concat(t.firstName.slice(0,1)).concat(t.lastName.slice(0,1))),r.a.createElement("div",{className:"messagesNavbar__list__item__message"},r.a.createElement("div",{className:"messagesNavbar__list__item__message__name"},"".concat(t.firstName," ").concat(t.lastName))))}))))}}]),t}(n.Component)),Fe=(a(314),function(){var e,t=new Date,a=t.getDate();e=a<10?"0"+a:a;var n=t.getMonth()+1,r=t.getFullYear(),s=t.getHours(),c=t.getMinutes(),i=t.getSeconds();return"".concat(e,"-").concat(n,"-").concat(r," ").concat(s,":").concat(c,":").concat(i)}),xe=function(e){var t,a,s=e.messages,c=e.showInfo,i="",o=s[0].timeStamp,l=s[0].timeStamp.slice(0,5);return a=s[0].senderType,s.map((function(e,u,d){var m=d[u].timeStamp.slice(0,5);return 0===u?i=o:m!==l&&u+1<d.length?(i=s[u].timeStamp,l=s[u].timeStamp.slice(0,5)):i="",u+1<d.length&&d[u+1].senderType===a?t="small":(t="big",u+1<d.length&&(a=d[u+1].senderType)),r.a.createElement("div",{key:e._id,className:"messagesContainer__body__chatContainer"},""!==i&&r.a.createElement("div",{className:"messagesContainer__body__chat__convoDate"},i),r.a.createElement("div",{className:"messagesContainer__body__chat               \n                                ".concat("small"===t?"small-gap":"big-gap")},r.a.createElement("div",{className:"messagesContainer__body__chat__content \n                                    ".concat("user"===e.senderType?"user":"admin")},e.message),r.a.createElement("div",{className:"messagesContainer__body__chat__detail\n                                    ".concat(c?"show":"","\n                                    ").concat("user"===e.senderType?"user":"admin")},"user"===e.senderType&&r.a.createElement(n.Fragment,null,r.a.createElement("span",null,e.timeStamp),r.a.createElement("span",null,"Lu par ",e.readBy," le ",e.readByTimeStamp)),"admin"===e.senderType&&r.a.createElement(n.Fragment,null,r.a.createElement("span",null,e.timeStamp," - ",e.from),!0===e.read&&r.a.createElement("span",null,"   Lu le ",e.readByTimeStamp," "),!1===e.read&&r.a.createElement("span",null,"Non lu")))))}))},Le=a(120),Me=a.n(Le),Ae=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.textarea.focus(),Me()(this.textarea)}},{key:"render",value:function(){var e=this;return r.a.createElement("textarea",{style:{maxHeight:"9rem",minHeight:"4rem",resize:"none",padding:".7rem",boxSizing:"border-box",fontSize:"1.6rem"},ref:function(t){return e.textarea=t},placeholder:this.props.placeholder,rows:1,value:this.props.value,onChange:function(t){return e.props.onChange(t.target.value)},className:this.props.className})}}]),t}(n.Component),Be=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={messages:null,messageInput:"",userId:"",showInfo:!1,showUserInfos:!0},a.toggleShowInfo=function(){a.setState((function(e){return Object(g.a)({},e,{showInfo:!e.showInfo})}))},a.toggleShowUserInfos=function(){a.setState((function(e){return Object(g.a)({},e,{showUserInfos:!e.showUserInfos})})),a.props.toggleShowUserInfos()},a.messageChangeHandler=function(e){a.setState({messageInput:e})},a.sendMessageHandler=function(){var e=Fe(),t="https://africauto.herokuapp.com/messages/admin/"+a.props.userId;fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({from:a.props.adminName,message:a.state.messageInput,timeStamp:e})}).then((function(e){return e.json()})).then((function(e){a.addMessages(e.data),a.setState({messageInput:""}),a.props.updateNavbar(e.data)})).catch((function(e){console.log(e)}))},a.addMessages=function(e){a.setState((function(t){return{messages:[].concat(Object(v.a)(t.messages),[e])}}),(function(){return a.scrollToBottom()}))},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){this._ismounted=!1}},{key:"componentDidMount",value:function(){var e=this;this._ismounted=!0,this.setState({messages:this.props.messages,userId:this.props.userId},(function(){return e.scrollToBottom()}));var t=Te()("https://africauto.herokuapp.com");t.on("userSentMessage",(function(t){if(e.props.playNotificationSound(),t.messageData.userId===e.state.userId&&!0===e._ismounted){var a="https://africauto.herokuapp.com/messages/admin-update/"+e.state.userId,n=Fe();fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminName:e.props.adminName,timeStamp:n})}).then((function(e){if(200!==e.status)throw new Error("Failed to fetch messages");return e.json()})).then((function(t){var a=t.user.messages.length-1;e.addMessages(t.user.messages[a])})).catch((function(e){console.log(e)}))}else{var r=t.messageData.userId;fetch("https://africauto.herokuapp.com/stats/add-notification/"+r,{method:"POST",headers:{"Content-Type":"application/json"}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed to add notification");return e.json()})).then((function(t){e.props.addANotification(t.notification)})).catch((function(e){console.log(e)}))}})),t.on("userReadNewMessages",(function(t){t._id===e.state.userId&&e.setState({messages:t.messages})}))}},{key:"componentDidUpdate",value:function(e){var t=this;e.userId!==this.props.userId&&this.setState({messages:this.props.messages,userId:this.props.userId},(function(){return t.scrollToBottom()}))}},{key:"scrollToBottom",value:function(){this.messagesEnd.scrollIntoView({behavior:"smooth"})}},{key:"render",value:function(){var e,t=this,a=this.state,s=a.displayDetails,c=a.messages,i=a.showInfo,o=a.showUserInfos;return e=c&&c.length>0?r.a.createElement(xe,{messages:c,displayDetails:s,showInfo:i}):r.a.createElement("div",{className:"messagesContainer__body__start"},"Start conversation"),r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"messagesContainer__body"},e,r.a.createElement("div",{ref:function(e){t.messagesEnd=e}})),r.a.createElement("div",{className:"messagesSender"},r.a.createElement("div",{className:"messagesSender__cta"},r.a.createElement("div",{className:"messagesSender__cta__iconContainer ".concat(o?"active":""),onClick:this.toggleShowUserInfos},r.a.createElement(D,{icon:"file"})),r.a.createElement("div",{className:"messagesSender__cta__iconContainer ".concat(i?"active":""),onClick:this.toggleShowInfo},r.a.createElement(D,{icon:"eye"})),r.a.createElement("div",{className:"messagesSender__cta__iconContainer"},r.a.createElement(D,{icon:"user"}))),r.a.createElement("div",{className:"messagesSender__textareaContainer"},r.a.createElement(Ae,{value:this.state.messageInput,placeholder:"message",onChange:this.messageChangeHandler,className:"messagesSender__textarea"}),r.a.createElement(D,{icon:"send",onClick:this.sendMessageHandler,customClass:"messagesSender__sender-btn"}))))}}]),t}(n.Component),qe=Object(p.b)((function(e){return{adminName:e.auth.adminName}}),(function(e){return{addANotification:function(t){return e(function(e){return{type:"ADD_A_NOTIFICATION",userId:e.userId}}(t))}}}))(Be),Re=(a(315),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={currentNotes:null,editingNote:!1,newNote:{title:"",text:""},userPhone:"",editUserPhone:!1,userStatus:null},a.editPhoneNumberStateHandler=function(e){a.setState({editUserPhone:e})},a.editPhoneNumber=function(e){a.setState({userPhone:e})},a.saveUserPhoneNumberHandler=function(){var e=a.props.user._id;fetch("https://africauto.herokuapp.com/user/edit-phone/"+e,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({phoneNumber:a.state.userPhone})}).then((function(e){if(200!==e.status)throw new Error("Failed to fetch messages");return e.json()})).then((function(e){a.setState({userPhone:e.userPhone,editUserPhone:!1})})).catch((function(e){console.log(e)}))},a.editNewNoteHandler=function(e,t){a.setState((function(a){return Object(g.a)({},a,{newNote:Object(g.a)({},a.newNote,Object(f.a)({},e,t))})}))},a.toggleAddingNewNoteHandler=function(){if(a.state.editingNote){a.setState({editingNote:!1,newNote:{title:"",text:""}})}else a.setState({editingNote:!0})},a.updateCurrentNote=function(e,t,n){var r={title:t,text:n,noteId:e};a.setState({newNote:r,editingNote:!0})},a.deleteNoteHandler=function(e){var t="https://africauto.herokuapp.com/user/delete-note/"+e,n=a.props.user._id;fetch(t,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:n})}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Could not delete supplier");return e.json()})).then((function(t){if("Note deleted"===t.message){var n=a.state.currentNotes.filter((function(t){return t._id!==e}));a.setState({currentNotes:n})}})).catch((function(e){console.log(e)}))},a.submitNewNoteHandler=function(e){e.preventDefault();var t,n,r,s=a.state.newNote,c=s.noteId;c?(t="https://africauto.herokuapp.com/user/edit-note/"+a.props.user._id,n="PUT",r=JSON.stringify({title:s.title,text:s.text,noteId:c})):(t="https://africauto.herokuapp.com/user/add-note/"+a.props.user._id,n="POST",r=JSON.stringify({title:s.title,text:s.text,timeStamp:Fe(),creator:a.props.adminName})),fetch(t,{method:n,headers:{"Content-Type":"application/json"},body:r}).then((function(e){if(200!==e.status)throw new Error("Failed to fetch messages");return e.json()})).then((function(e){a.setState({currentNotes:e.newNoteList,editingNote:!1,newNote:{title:"",text:""}})})).catch((function(e){console.log(e)}))},a.toggleShowNoteHandler=function(e){var t=a.state.currentNotes;t.forEach((function(t){t._id===e&&(t.show=!t.show)})),a.setState({currentNotes:t})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.user;t.notes.forEach((function(e){e.show=!1}));var a="";t.phoneNumber&&""!==t.phoneNumber&&(a=t.phoneNumber),this.setState({currentNotes:t.notes,userStatus:t.active,userPhone:a});var n=Te()("https://africauto.herokuapp.com");n.on("userLoggedIn",(function(a){a._id===t._id&&e.setState({userStatus:!0})})),n.on("userLoggedOut",(function(a){a._id===t._id&&e.setState({userStatus:!1})}))}},{key:"componentDidUpdate",value:function(e){if(e.user._id!==this.props.user._id){var t=this.props.user;t.notes.forEach((function(e){e.show=!1})),this.setState({currentNotes:t.notes,userStatus:t.active,userPhone:t.phoneNumber,editUserPhone:!1})}}},{key:"render",value:function(){var e=this,t=this.state,a=t.currentNotes,n=t.editUserPhone,s=t.editingNote,c=t.newNote,i=t.userStatus,o=t.userPhone,l=this.props.user;return r.a.createElement("div",{className:"messagesUserInfos"},r.a.createElement("header",{className:"messagesUserInfos__header"},r.a.createElement("div",{className:"messagesUserInfos__header__name"},l.firstName," ",l.lastName),r.a.createElement("div",{className:"messagesUserInfos__header__status ".concat(i?"active":"away")},i?"active":"away")),r.a.createElement("div",{className:"messagesuserInfos__contact"},r.a.createElement("div",{className:"messagesUserInfo__contact__group"},r.a.createElement(D,{icon:"email"}),r.a.createElement("span",null,l.email)),r.a.createElement("div",{className:"messagesUserInfo__contact__group messagesUserInfo__contact__group--editable"},r.a.createElement(D,{icon:"phone"}),r.a.createElement("div",{className:"messagesUserInfo__contact__group__value ".concat(n?"edit":""),onClick:function(){return e.editPhoneNumberStateHandler(!0)}},r.a.createElement("div",{className:"messagesUserInfo__contact__group__value--value"},o&&""!==o?o:"N.D."),r.a.createElement("input",{className:"messagesUserInfo__contact__group__value--input",value:void 0!==o?o:"",onChange:function(t){return e.editPhoneNumber(t.target.value)}}))),r.a.createElement("div",{className:"messagesUserInfo__contact__cta\n                                    ".concat(n?"show":"")},r.a.createElement(A,{color:"primary",onClick:this.saveUserPhoneNumberHandler},"Save"),r.a.createElement(A,{color:"primary",onClick:function(){return e.editPhoneNumberStateHandler(!1)}},"Cancel"))),r.a.createElement("section",{className:"messagesUserInfos__notes"},r.a.createElement("div",{className:"messagesUserInfos__notes__title"},r.a.createElement("span",null,"Notes"),r.a.createElement("div",{className:"messagesUserInfos__notes__title__icon"},r.a.createElement(D,{icon:"add",onClick:this.toggleAddingNewNoteHandler}))),s&&r.a.createElement("form",{className:"messagesUserInfos__notes__form",onSubmit:function(t){return e.submitNewNoteHandler(t)}},r.a.createElement("div",{className:"messagesUserInfos__notes__form__title"},"New note"),r.a.createElement("input",{className:"messagesUserInfos__notes__form__input",value:c.title,placeholder:"Title",onChange:function(t){return e.editNewNoteHandler("title",t.target.value)}}),r.a.createElement("textarea",{className:"messagesUserInfos__notes__form__textarea",value:c.text,placeholder:"Details...",onChange:function(t){return e.editNewNoteHandler("text",t.target.value)}}),r.a.createElement("div",{className:"messagesUserInfos__notes__form__cta"},r.a.createElement(A,{color:"primary",type:"submit"},"Add"),r.a.createElement(A,{color:"primary",onClick:this.toggleAddingNewNoteHandler},"Cancel"))),a&&!s&&r.a.createElement("ul",{className:"messagesUserInfos__notes__list"},a.map((function(t){return r.a.createElement("li",{key:t._id,className:"messagesUserInfos__notes__list__item\n                                                            ".concat(t.show?"show":"")},r.a.createElement("div",{className:"messagesUserInfos__notes__list__item__title",onClick:function(){return e.toggleShowNoteHandler(t._id)}},r.a.createElement("span",null,t.title),r.a.createElement("div",{className:"messagesUserInfos__notes__list__item__title__cta"},r.a.createElement(D,{icon:"pencil",onClick:function(){return e.updateCurrentNote(t._id,t.title,t.text)}}),r.a.createElement(D,{icon:"bin",onClick:function(){return e.deleteNoteHandler(t._id)}}))),r.a.createElement("p",{className:"messagesUserInfos__notes__list__item__text"},t.text))})))))}}]),t}(n.Component)),Ge=Object(p.b)((function(e){return{adminName:e.auth.adminName}}))(Re),Ve=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={messages:null,loading:!0,requestedUser:null,showUserInfos:!0},a.changeConvoHandler=function(e){a.fetchUserMessages(e)},a.fetchUserMessages=function(e){var t="https://africauto.herokuapp.com/messages/admin-update/"+e,n=Fe();fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminName:a.props.adminName,timeStamp:n})}).then((function(e){if(200!==e.status)throw new Error("Failed to fetch messages");return e.json()})).then((function(t){a.setState({requestedUser:t.user,loading:!1}),a.props.substractANotification(e)})).catch((function(e){console.log(e)}))},a.updateNavbar=function(e){var t=e.userId,n=a.state.messages.filter((function(e){return e._id===t}))[0];n.messages[0]=e;var r=a.state.messages.filter((function(e){return e._id!==t})),s=[n].concat(Object(v.a)(r));a.setState({messages:s})},a.toggleShowUserInfos=function(){a.setState((function(e){return Object(g.a)({},e,{showUserInfos:!e.showUserInfos})}))},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("https://africauto.herokuapp.com/messages",{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){if(200!==e.status)throw new Error("Failed to fetch messages");return e.json()})).then((function(t){0!==t.messages[0].messages.length&&e.setState({messages:t.messages,requestedMessageUserId:t.messages[0]._id},(function(){return e.fetchUserMessages(t.messages[0]._id)}))})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this.state,t=e.requestedUser,a=e.loading,n=e.messages,s=e.showUserInfos,c=r.a.createElement(h,null);return t&&t.messages&&(c=r.a.createElement(qe,{messages:t.messages,userId:t._id,updateNavbar:this.updateNavbar,playNotificationSound:this.props.playNotificationSound,loading:a,toggleShowUserInfos:this.toggleShowUserInfos})),r.a.createElement("section",{className:"messages"},r.a.createElement("div",{className:"messages__navbar"},t&&r.a.createElement(Ue,{messages:n,requestedMessageUserId:t._id,onchangeConvoHandler:this.changeConvoHandler})),r.a.createElement("section",{className:"messages__container ".concat(s?"full":"")},c),r.a.createElement("div",{className:"messages__userInfos ".concat(s?"show":"")},t&&r.a.createElement(Ge,{user:t})))}}]),t}(n.Component),ze=Object(p.b)((function(e){return{adminName:e.auth.adminName}}),(function(e){return{substractANotification:function(t){return e(function(e){return{type:"SUBSTRACT_A_NOTIFICATION",userId:e}}(t))}}}))(Ve),Ye=(a(316),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={data:null,globalDataSet:null},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e,t=this.props.data,a={};t.forEach((function(e){var t=e.start.split(" ")[0],n=t.split("-")[0],r=t.split("-")[1],s=t.split("-")[2],c=("".concat(r,"-").concat(n,"-").concat(s),"".concat(r,"-").concat(n));a=Object.keys(a).includes(c)?Object(g.a)({},a,Object(f.a)({},c,a[c]+1)):Object(g.a)({},a,Object(f.a)({},c,1))}));var n=[];Object.keys(a).forEach((function(e){n=[].concat(Object(v.a)(n),[a[e]])})),e={labels:Object.keys(a),datasets:[{label:"Number of connections",data:n,backgroundColor:"transparent"}]},this.setState({data:e,globalDataSet:t})}},{key:"render",value:function(){var e=this.state.data,t=r.a.createElement("div",null,"loading");return e&&(t=r.a.createElement(V.a,{options:{responsive:!0,scales:{yAxes:[{ticks:{beginAtZero:!0,stepSize:1}}]}},data:e})),r.a.createElement("div",{className:"user-account__chart"},r.a.createElement("div",{className:"user-account__chart__container"},t))}}]),t}(n.Component)),We=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={user:null,userFavoriteProducts:null,userViewedProducts:null},a.fetchUserAccountDetails=function(){var e="https://africauto.herokuapp.com/admin/user/"+a.props.match.params.userId;fetch(e,{headers:{"Content-Type":"application/json"}}).then((function(e){if(200!==e.status)throw new Error("Failed to fetch users");return e.json()})).then((function(e){a.setState({user:e.user,userFavoriteProducts:e.favorites,userViewedProducts:e.viewedProducts})})).catch((function(e){console.log(e)}))},a.elapsedTimeCalculator=function(e){var t,a,n,r=e.end.substr(3,2)+"-"+e.end.substr(0,2)+"-"+e.end.substr(6,4)+" "+e.end.split(" ")[1],s=e.start.substr(3,2)+"-"+e.start.substr(0,2)+"-"+e.start.substr(6,4)+" "+e.start.split(" ")[1],c=new Date(r)-new Date(s);return c/1e3/60>60?(t=Math.floor(c/1e3/60/60)+"h",a=Math.floor(c/1e3/60%60)+"min",n=Math.floor(c/1e3/60%60)%60+"sec","".concat(t," ").concat(a," ").concat(n)):c/1e3>60?(a=Math.floor(c/1e3/60)+"min",n=c/1e3%60+"sec","".concat(a," ").concat(n)):c/1e3+"sec"},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.fetchUserAccountDetails()}},{key:"render",value:function(){var e=this,t=this.state,a=t.user,n=t.userFavoriteProducts,s=t.userViewedProducts,c=r.a.createElement("div",{className:"user-account__products-list--noProduct"},"This user doesn't have favorite products yet");return n&&n.length>0&&(c=r.a.createElement("ul",{className:"user-account__products-list"},n.map((function(t){return r.a.createElement(H,{key:t._id,id:t._id,mainImg:t.general.mainImgUrl,made:t.general.made,model:t.general.model,year:t.general.year,price:t.general.price,nbKilometers:t.general.nbKilometers,gazol:t.general.gazol,transmissionType:t.general.transmissionType,goToProd:function(){e.props.setProductRequestedId(t._id),e.props.history.push("/car/".concat(t._id))}})})))),a?r.a.createElement("div",{className:"user-account"},r.a.createElement("header",{className:"user-account__header"},r.a.createElement("div",{className:"user-account__header__id"},r.a.createElement("div",{className:"user-account__header__id__avatar"},a.firstName.slice(0,1),a.lastName.slice(0,1)),r.a.createElement("div",{className:"user__account__header__id__name"},a.firstName," ",a.lastName)),r.a.createElement("div",{className:"user-account__header__infos"},r.a.createElement("div",{className:"user-account__header__infos__group"},r.a.createElement(D,{icon:"email"}),r.a.createElement("div",null,a.email)),r.a.createElement("div",{className:"user-account__header__infos__group"},r.a.createElement(D,{icon:"phone"}),r.a.createElement("div",null,a.phoneNumber&&""!==a.phoneNumber?a.phoneNumber:"N.D."))),r.a.createElement("div",{className:"user-account__header__status\n                                                ".concat(a.active?"active":"away")},a.active?"active":"away")),r.a.createElement("section",{className:"user-account__section user-account__favorites"},r.a.createElement("h3",{className:"user-account__section-title"},"Favorite Products"),c),r.a.createElement("section",{className:"user-account__section user-account__viewed"},r.a.createElement("h3",{className:"user-account__section-title"},"Viewed Products"),r.a.createElement("ul",{className:"user-account__products-list"},s.map((function(t){return r.a.createElement(H,{key:t._id,id:t._id,mainImg:t.general.mainImgUrl,made:t.general.made,model:t.general.model,year:t.general.year,price:t.general.price,nbKilometers:t.general.nbKilometers,gazol:t.general.gazol,transmissionType:t.general.transmissionType,goToProd:function(){e.props.setProductRequestedId(t._id),e.props.history.push("/car/".concat(t._id))}})})))),r.a.createElement("section",{className:"user-account__section"},r.a.createElement("h3",{className:"user-account__section-title"},"Connection History"),r.a.createElement(Ye,{data:a.connection}))):r.a.createElement("div",null,"Loading...")}}]),t}(n.Component),Ke=Object(p.b)(null,(function(e){return{setProductRequestedId:function(t){return e(O(t))}}}))(We),Je=(a(317),function(e){var t=e.suppliers;return r.a.createElement("ul",{className:"suppliers__list"},r.a.createElement(W,{title:"Suppliers"},r.a.createElement("div",{className:"suppliers__addButton",onClick:function(){return e.supplierCurrentViewHandler("suppliersForm")}},"Add")),t.map((function(t){return r.a.createElement("li",{className:"suppliers__list__item",key:t._id},r.a.createElement("div",{className:"suppliers__list__item__header"},r.a.createElement("h3",{className:"suppliers__list__item__header__name"},t.name),r.a.createElement("div",{className:"suppliers__list__item__header__cta"},r.a.createElement("div",{className:"suppliers__list__item__header__cta__btn suppliers__list__item__header__cta__btn--edit",onClick:function(){return e.editSupplierHandler(t)}},"Edit"),r.a.createElement("div",{className:"suppliers__list__item__header__cta__btn suppliers__list__item__header__cta__btn--delete",onClick:function(){return e.deleteSupplierHandler(t._id)}},"Delete"))),r.a.createElement("div",{className:"suppliers__list__item__infoGroup"},r.a.createElement("div",{className:"suppliers__list__item__info"},t.email),r.a.createElement("div",{className:"suppliers__list__item__info"},t.phoneNumber),r.a.createElement("div",{className:"suppliers__list__item__info"},t.address)),r.a.createElement("div",{className:"suppliers__list__item__nav"},r.a.createElement("div",{className:"suppliers__list__item__nav__item\n                                                ".concat("contacts"===t.currentView?"active":""),onClick:function(){return e.supplierNavigationHandler(t._id,"contacts")}},"Contacts")),r.a.createElement("table",{className:"suppliers__list__item__responsiblesTable"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Email"),r.a.createElement("th",null,"Phone Number"),r.a.createElement("th",null,"Poste"))),r.a.createElement("tbody",null,t.responsibles.map((function(e){return r.a.createElement("tr",{className:"suppliers__list__item__responsiblesTable__row",key:e},r.a.createElement("td",{className:"suppliers__list__item__responsiblesTable__row__data"},e.name),r.a.createElement("td",{className:"suppliers__list__item__responsiblesTable__row__data"},e.email),r.a.createElement("td",{className:"suppliers__list__item__responsiblesTable__row__data"},e.phoneNumber),r.a.createElement("td",{className:"suppliers__list__item__responsiblesTable__row__data"},e.title))})))))})))}),Qe=function(e){var t=e.addSupplierForm,a=e.responsiblesForm;return r.a.createElement("form",{className:"suppliers__form",onSubmit:function(n){return e.addSupplierHandler(n,t,a)}},r.a.createElement(W,{title:" Add supplier"},r.a.createElement("div",{className:"suppliers__addButton",onClick:function(){return e.supplierCurrentViewHandler("suppliersList")}},"List")),Object.keys(t).map((function(a){return r.a.createElement(ie,{className:"add-product__input",label:a,key:a,id:a,placeholder:a,control:"input",type:t[a].type,value:t[a].value,onChange:e.addSupplierFormChangeHandler,formType:"addSupplierForm"})})),r.a.createElement("div",{className:"suppliers__form__add-responsible"},r.a.createElement("h2",{className:"suppliers__form__add-responsible__title"},"Responsible"),r.a.createElement("div",{className:"suppliers__form__add-responsible__cta",onClick:e.addResponsibleHandler},"+")),Object.keys(a).length>0&&Object.keys(a).map((function(t,n){return r.a.createElement("div",{className:"suppliers__form__responsible",key:n},r.a.createElement("h3",{className:"suppliers__form__responsible__rank"},t),Object.keys(a[t]).map((function(n,s){return r.a.createElement(ie,{className:"suppliers__form__responsible__input",label:n,key:s,id:t,placeholder:n,control:"input",type:a[t][n].type,value:a[t][n].value,onChange:e.responsibleInputHandler.bind(void 0,n),formType:"responsiblesForm"})})))})),r.a.createElement("div",{className:"suppliers__form__cta"},r.a.createElement(A,{color:"primary",type:"submit"},e.editingMode?"Update":"Add")))},Ze=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={addSupplierForm:{name:{value:""},email:{value:"",type:"email"},phoneNumber:{value:""},address:{value:""}},responsiblesForm:{},suppliers:null,loading:!0,currentView:"suppliersList",editingMode:!1,currentSupplierBeingEditedId:null},a.fetchSuppliers=function(){fetch("https://africauto.herokuapp.com/suppliers",{headers:{"Content-Type":"application/json"}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Could not fetch suppliers");return e.json()})).then((function(e){var t=e.suppliers;t.forEach((function(e){e.currentView="contacts"})),a.setState({suppliers:t,loading:!1}),a.props.setSuppliers(t)})).catch((function(e){console.log(e)}))},a.deleteSupplierHandler=function(e){var t=a.state.suppliers;fetch("https://africauto.herokuapp.com/suppliers/delete-supplier/"+e,{method:"DELETE",headers:{"Content-Type":"application/json"}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Could not delete supplier");return e.json()})).then((function(n){console.log(n);var r=t.filter((function(t){return t._id!==e}));a.props.setSuppliers(r),a.setState({suppliers:r})})).catch((function(e){console.log(e)}))},a.addSupplierHandler=function(e,t,n){e.preventDefault();var r=a.state,s=r.editingMode,c=r.currentSupplierBeingEditedId,i=r.suppliers,o="https://africauto.herokuapp.com/suppliers/add-supplier",l="POST",u={name:t.name.value,email:t.email.value,phoneNumber:t.phoneNumber.value,address:t.address.value,responsibles:n};s&&(l="PUT",o="https://africauto.herokuapp.com/suppliers/edit-supplier",u=Object(g.a)({},u,{_id:c})),fetch(o,{method:l,headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}).then((function(e){if(422===e.status)throw new Error("Add supplier failed");if(200!==e.status&&201!==e.status)throw new Error("Could not add supplier");return e.json()})).then((function(e){var t=[],n=Object(g.a)({},e.supplier,{currentView:"contacts"});if(s){var r=i.findIndex((function(t){return t._id===e.supplier._id}));(t=Object(v.a)(i))[r]=n}else t=null!==i?[].concat(Object(v.a)(i),[n]):[n];a.props.setSuppliers(t),a.setState({suppliers:t,currentView:"suppliersList"},(function(){return a.resetFormHandler()}))})).catch((function(e){console.log(e)}))},a.addSupplierFormChangeHandler=function(e,t){a.setState((function(a){return{addSupplierForm:Object(g.a)({},a.addSupplierForm,Object(f.a)({},e,Object(g.a)({},a.addSupplierForm[e],{value:t})))}}))},a.responsibleInputHandler=function(e,t,n){a.setState((function(a){return{responsiblesForm:Object(g.a)({},a.responsiblesForm,Object(f.a)({},t,Object(g.a)({},a.responsiblesForm[t],Object(f.a)({},e,Object(g.a)({},a.responsiblesForm[t][e],{value:n})))))}}))},a.addResponsibleHandler=function(){var e=a.state.responsiblesForm,t=Object.keys(e).length,n="0".concat(t+1,"-Responsible");e=Object(g.a)({},e,Object(f.a)({},n,{name:{value:"",type:"text"},email:{value:"",type:"email"},phoneNumber:{value:"",type:"text"},title:{value:"",type:"text"}})),a.setState({responsiblesForm:e})},a.supplierNavigationHandler=function(e,t){var n=a.state.suppliers;n.forEach((function(a){a._id===e&&(a.currentView=t)})),a.setState({suppliers:n})},a.resetFormHandler=function(){a.setState({addSupplierForm:{name:{value:""},email:{value:"",type:"email"},phoneNumber:{value:""},address:{value:""}},responsiblesForm:{},editingMode:!1,currentView:"suppliersList",currentSupplierBeingEditedId:null})},a.supplierCurrentViewHandler=function(e){"suppliersList"===e&&!0===a.state.editingMode?a.resetFormHandler():a.setState({currentView:e})},a.editSupplierHandler=function(e){var t={name:{value:e.name},email:{value:e.email,type:"email"},phoneNumber:{value:e.phoneNumber},address:{value:e.address}},n=e.responsibles,r={};n.map((function(e,t){var a="0".concat(t+1,"-Responsible");r=Object(g.a)({},r,Object(f.a)({},a,{name:{value:e.name,type:"text"},email:{value:e.email,type:"email"},phoneNumber:{value:e.phoneNumber,type:"text"},title:{value:e.title,type:"text"}}))})),a.setState({addSupplierForm:t,responsiblesForm:r,currentView:"suppliersForm",editingMode:!0,currentSupplierBeingEditedId:e._id})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.suppliers?this.setState({suppliers:this.props.suppliers,loading:!1}):this.fetchSuppliers()}},{key:"render",value:function(){var e=this.state,t=e.addSupplierForm,a=e.responsiblesForm,n=e.suppliers,s=e.loading,c=e.currentView,i=e.editingMode,o=r.a.createElement(h,null);!s&&n&&(o=r.a.createElement(Je,{suppliers:n,supplierNavigationHandler:this.supplierNavigationHandler,supplierCurrentViewHandler:this.supplierCurrentViewHandler,editSupplierHandler:this.editSupplierHandler,deleteSupplierHandler:this.deleteSupplierHandler}));var l=r.a.createElement(Qe,{addSupplierForm:t,responsiblesForm:a,addSupplierHandler:this.addSupplierHandler,editingMode:i,addResponsibleHandler:this.addResponsibleHandler,addSupplierFormChangeHandler:this.addSupplierFormChangeHandler,responsibleInputHandler:this.responsibleInputHandler,supplierCurrentViewHandler:this.supplierCurrentViewHandler});return r.a.createElement("div",{className:"suppliers"},"suppliersList"===c&&o,"suppliersForm"===c&&l)}}]),t}(n.Component),Xe=Object(p.b)((function(e){return{suppliers:e.suppliers.suppliers}}),(function(e){return{setSuppliers:function(t){return e(I(t))}}}))(Ze),$e=(a(318),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={users:null,showUsersList:!1},a.handleClick=function(e){a.target&&a.target.contains(e.target)||a.state.showUsersList&&a.hideUsersList()},a.showUsersListToggler=function(){a.setState((function(e){return Object(g.a)({},e,{showUsersList:!e.showUsersList})}))},a.hideUsersList=function(){a.setState({showUsersList:!1})},a.fetchUsersHandler=function(){fetch("http://localhost:8000/admin/connected-users",{headers:{"Content-Type":"application/json"}}).then((function(e){if(200!==e.status)throw new Error("Failed to fetch users");return e.json()})).then((function(e){a.setState({users:e.users})})).catch((function(e){console.log(e)}))},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){document.addEventListener("mousedown",this.handleClick,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClick,!1)}},{key:"componentDidMount",value:function(){this.fetchUsersHandler()}},{key:"render",value:function(){var e=this,t=this.state,a=t.users,n=t.showUsersList,s="";return a&&(s=r.a.createElement("div",{className:"nav__top__connected",ref:function(t){return e.target=t}},r.a.createElement("div",{className:"nav__top__connected__count",onClick:this.showUsersListToggler},r.a.createElement("div",{className:"nav__top__connected__count__icon"},r.a.createElement(D,{icon:"users"}),r.a.createElement("div",{className:"nav__top__connected__count__icon__status ".concat(a.length>0?"green":"red")})),a.length>0&&r.a.createElement("span",null,a.length)),a.length>0&&r.a.createElement("ul",{className:"nav__top__connected__list ".concat(n?"active":"")},a.map((function(e,t){return r.a.createElement("li",{className:"nav__top__connected__list__item",key:t},r.a.createElement("div",{className:"nav__top__connected__list__item__avatar"},e.firstName.slice(0,1),e.lastName.slice(0,1)),r.a.createElement("div",{className:"nav__top__connected__list__item__name"},e.firstName," ",e.lastName))}))))),r.a.createElement("div",{className:"navtop"},r.a.createElement("div",{className:"navtop__logo"},"WOTO ADMIN"),this.props.auth&&this.props.token&&this.props.adminId&&this.props.adminNAme&&r.a.createElement("div",{className:"navtop__cta"},s,r.a.createElement("div",{className:"navtop__cta__logout",onClick:this.props.logoutHandler},"Logout")))}}]),t}(n.Component)),et=Object(p.b)((function(e){return{auth:e.auth.auth,token:e.auth.auth,adminId:e.auth.adminId,adminName:e.auth.adminName}}))($e),tt=(a(319),[{path:"stats",text:"Statistiques",icon:"stats"},{path:"users",text:"Users",icon:"users"},{path:"publicity",text:"Publicit\xe9",icon:"pub"},{path:"ajouter",text:"Ajouter",icon:"pencil"},{path:"fournisseurs",text:"Fournisseurs",icon:"hand-shake"}]),at=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("http://localhost:8000/stats/notifications",{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed to get notifications");return e.json()})).then((function(t){e.props.initNotifications(t.notifData)})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return r.a.createElement("ul",{className:"navbar__list ".concat(!0===this.props.showFullNavbar?"":"small")},!0===this.props.showFullNavbar&&r.a.createElement(D,{icon:"chevrons-left",customClass:"navbar__list__toggle",onClick:this.props.toggleShowFullNavbar}),!1===this.props.showFullNavbar&&r.a.createElement(D,{icon:"chevrons-right",customClass:"navbar__list__toggle",onClick:this.props.toggleShowFullNavbar}),r.a.createElement(i.c,{to:"/inventory",className:"navbar__list__item \n                                            ".concat(!0===this.props.showFullNavbar?"":"hide")},r.a.createElement(D,{icon:"inventory"}),r.a.createElement("span",{className:"navbar__list__item__text"},"Inventaire")),r.a.createElement(i.c,{to:"/messages",className:"navbar__list__item \n                                            ".concat(!0===this.props.showFullNavbar?"":"hide")},r.a.createElement(D,{icon:"email"}),r.a.createElement("span",{className:"navbar__list__item__text"},"Messages"),this.props.notification.length>0&&r.a.createElement("div",{className:"navbar__list__item__notification"},r.a.createElement("span",null,this.props.notification.length))),tt.map((function(t){return r.a.createElement(i.c,{key:t.path,to:"/".concat(t.path),className:"navbar__list__item \n                                        ".concat(!0===e.props.showFullNavbar?"":"hide")},r.a.createElement(D,{icon:t.icon}),r.a.createElement("span",{className:"navbar__list__item__text"},t.text))})))}}]),t}(n.Component),nt=Object(p.b)((function(e){return{showFullNavbar:e.nav.showFullNavbar,notification:e.nav.notification}}),(function(e){return{toggleShowFullNavbar:function(){return e({type:"TOGGLE_SHOW_FULL_NAVBAR"})},initNotifications:function(t){return e(function(e){return{type:"INIT_NOTIFICATIONS",notifData:e}}(t))}}}))(at),rt=(a(320),n.Component,a(121)),st=a.n(rt),ct=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!0,hideScrollBar:!1},a.showScrollBarHandler=function(){a.setState({hideScrollBar:!1},(function(){return document.body.className=""}))},a.hideScrollBarHandler=function(){a.setState({hideScrollBar:!0},(function(){return document.body.className="hideScrollBar"}))},a.initializeDatasHandler=function(){fetch("https://africauto.herokuapp.com/init",{headers:{"Content-Type":"application/json"}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Could not fetch suppliers");return e.json()})).then((function(e){var t=e.suppliers;t.forEach((function(e){e.currentView="contacts"})),a.props.setSuppliers(t),a.props.initAppData(e),a.setState({loading:!1})})).catch((function(e){console.log(e)}))},a.playNotificationSound=function(){a.player.play()},a.logoutHandler=function(){a.props.setLoginStateToFalse(),localStorage.removeItem("woto-admin-token"),localStorage.removeItem("woto-admin-expiryDate"),localStorage.removeItem("woto-admin-adminId"),localStorage.removeItem("woto-admin-adminName"),a.props.history.push("/")},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("woto-admin-token"),t=localStorage.getItem("woto-admin-expiryData"),a=localStorage.getItem("woto-admin-adminId"),n=localStorage.getItem("woto-admin-adminName");this.initializeDatasHandler(),e&&t?new Date(t)<=new Date?console.log("Token not valid anymore"):this.props.setLoginStateToTrue(!0,e,a,n):console.log("NO TOKEN")}},{key:"render",value:function(){var e,t=this,a=this.state.hideScrollBar;return e=!0===this.state.loading?r.a.createElement(h,{fullView:!0}):this.props.token&&this.props.adminId&&this.props.auth&&this.props.adminName?r.a.createElement(n.Fragment,null,r.a.createElement(nt,null),r.a.createElement("audio",{src:st.a,ref:function(e){return t.player=e}}),r.a.createElement(_.c,null,r.a.createElement(_.a,{exact:!0,path:"/",component:M}),r.a.createElement(_.a,{path:"/inventory/:prodId",render:function(e){return r.a.createElement(Pe,Object.assign({},e,{hideScrollBar:a,showScrollBarHandler:t.showScrollBarHandler,hideScrollBarHandler:t.hideScrollBarHandler}))}}),r.a.createElement(_.a,{path:"/inventory",component:M}),r.a.createElement(_.a,{path:"/ajouter",component:fe}),r.a.createElement(_.a,{path:"/publicity",component:G}),r.a.createElement(_.a,{path:"/users/:userId",component:Ke}),r.a.createElement(_.a,{path:"/users",component:He}),r.a.createElement(_.a,{path:"/stats",component:te}),r.a.createElement(_.a,{path:"/fournisseurs",component:Xe}),r.a.createElement(_.a,{path:"/messages",render:function(e){return r.a.createElement(ze,Object.assign({},e,{playNotificationSound:t.playNotificationSound}))}}))):r.a.createElement("div",{className:"fullScreen"},r.a.createElement(je,null)),r.a.createElement("div",{className:"app  ".concat(!0===this.props.showFullNavbar?"":"full-app")},r.a.createElement(et,{logoutHandler:this.logoutHandler}),null!==this.props.errors&&r.a.createElement(Ie,null),e)}}]),t}(n.Component),it=Object(p.b)((function(e){return{showFullNavbar:e.nav.showFullNavbar,loading:e.nav.loading,auth:e.auth.auth,token:e.auth.auth,adminId:e.auth.adminId,adminName:e.auth.adminName,errors:e.error.errors}}),(function(e){return{setLoginStateToTrue:function(t,a,n,r){return e(function(e,t,a,n){return{type:"SET_LOGIN_STATE_TO_TRUE",isAuth:e,token:t,adminId:a,adminName:n}}(t,a,n,r))},setLoginStateToFalse:function(){return e({type:"SET_LOGIN_STATE_TO_FALSE"})},initAppData:function(t){return e(function(e){return{type:"INIT_APP_DATA",data:e}}(t))},setSuppliers:function(t){return e(I(t))}}}))(Object(_.f)(ct));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ot=a(29),lt=a(122),ut=function(e,t){return Object(g.a)({},e,{},t)},dt={productRequested:{},productRequestedId:"",editingMode:!1,products:[],brandAndModelsData:null,price:null,bodyTypeList:null,totalProducts:null,itemsPerPage:20,currentInventoryPage:1},mt=function(e,t){return ut(e,{brandAndModelsData:t.data.brandAndModelsData,price:t.data.price,bodyTypeList:t.data.bodyTypeList,totalProducts:t.data.totalProducts})},_t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_APP_DATA":return mt(e,t);case"SET_REQUESTED_PRODUCT":return ut(e,{productRequested:t.product});case"SET_REQUESTED_PRODUCT_ID":return ut(e,{productRequestedId:t.id});case"TOGGLE_EDITING_MODE":return ut(e,{editingMode:!e.editingMode});case"SET_PRODUCTS":return ut(e,{products:t.products});case"ADD_TOTAL_PRODUCTS":return ut(e,{totalProducts:e.totalProducts+1});case"SET_CURRENT_PAGE":return ut(e,{currentInventoryPage:t.page});default:return e}},pt={showFullNavbar:!1,notification:[]},ht=function(e,t){var a;return e.notification.includes(t.userId)?e:(a=[].concat(Object(v.a)(e.notification),[t.userId]),ut(e,{notification:a}))},ft=function(e,t){var a=e.notification.filter((function(e){return e!==t.userId}));return ut(e,{notification:a})},gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_SHOW_FULL_NAVBAR":return ut(e,{showFullNavbar:!e.showFullNavbar});case"INIT_NOTIFICATIONS":return ut(e,{notification:t.notifData});case"ADD_A_NOTIFICATION":return ht(e,t);case"SUBSTRACT_A_NOTIFICATION":return ft(e,t);default:return e}},vt={auth:!1,token:null,adminId:null,adminName:null},Et=function(e,t){return ut(e,{auth:!0,token:t.token,adminId:t.adminId,adminName:t.adminName})},bt=function(e,t){return ut(e,{auth:t.isAuth,token:t.token,adminId:t.adminId,adminName:t.adminName})},yt=function(e){return ut(e,{auth:!1,token:null,adminId:null,adminName:null})},Nt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_SUCCEDED":return Et(e,t);case"LOGIN_FAILED":return e;case"SET_LOGIN_STATE_TO_TRUE":return bt(e,t);case"SET_LOGIN_STATE_TO_FALSE":return yt(e);default:return e}},Pt={suppliers:null},St=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SUPPLIERS":return ut(e,{suppliers:t.suppliers});default:return e}},wt={errors:null},Ct=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ERROR":return ut(e,{errors:t.data});default:return e}},Ot={INIT_pubProducts:null,INIT_homePageProducts:null,currentPubProducts:null,currentHomePageProducts:null,selectedPubProducts:[],selectedHomePageProducts:[],newPubProducts:[],newHomePageProducts:[],showSelector:!1,selectorTitle:null,editingMode:[],selectorSelectedProductsIds:[],selectorSelectedProductsDetails:[]},It=function(e,t){return ut(e,{INIT_pubProducts:t.pubProducts,INIT_homePageProducts:t.homePageProducts,currentPubProducts:t.pubProducts,currentHomePageProducts:t.homePageProducts})},jt=function(e,t){return"publicity"===t.section?ut(e,{currentPubProducts:e.INIT_pubProducts,selectedPubProducts:[],editingMode:e.editingMode.filter((function(e){return e!==t.section})),selectorSelectedProductsIds:[],selectorSelectedProductsDetails:[],newPubProducts:[]}):"home page"===t.section?ut(e,{currentHomePageProducts:e.INIT_homePageProducts,selectedHomePageProducts:[],editingMode:e.editingMode.filter((function(e){return e!==t.section})),selectorSelectedProductsIds:[],selectorSelectedProductsDetails:[],newHomePageProducts:[]}):void 0},kt=function(e,t){var a=null;return e.showSelector||(a=t.section),ut(e,{showSelector:!e.showSelector,selectorTitle:a})},Tt=function(e,t){return ut(e,{selectorSelectedProductsIds:t.productsIds,selectorSelectedProductsDetails:t.productsDetails})},Dt=function(e,t){return ut(e,{newPubProducts:t.data,selectorSelectedProductsIds:[],selectorSelectedProductsDetails:[]})},Ht=function(e,t){return ut(e,{newHomePageProducts:t.data,selectorSelectedProductsIds:[],selectorSelectedProductsDetails:[]})},Ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ot,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PUBLICITY_DATA":return It(e,t);case"SET_PUBLICITY_EDITING_MODE":return ut(e,{editingMode:t.editingMode});case"SET_PUBLICITY_SELECTED_PUB_PRODUCTS":return ut(e,{selectedPubProducts:t.data});case"SET_PUBLICITY_SELECTED_HOMEPAGE_PRODUCTS":return ut(e,{selectedHomePageProducts:t.data});case"CANCEL_PUBLICITY_EDITING_MODE":return jt(e,t);case"DELETE_PUBLICITY_SELECTED_PUB_PRODUCTS":return ut(e,{currentPubProducts:t.data});case"DELETE_PUBLICITY_SELECTED_HOMEPAGE_PRODUCTS":return ut(e,{currentHomePageProducts:t.data});case"TOGGLE_PUBLICITY_SELECTOR":return kt(e,t);case"SET_PUBLICITY_SELECTOR_SELECTED_PRODUCTS":return Tt(e,t);case"ADD_PUBLICITY_PUB_PRODUCTS":return Dt(e,t);case"ADD__PUBLICITY__HOMEPAGE__PRODUCTS":return Ht(e,t);default:return e}},Ft={lang:"english",currency:"CAD",quotes:{USDCAD:1.32357,USDEUR:.92693,EURUSD:1.0788,EURCAD:1.4289,CADUSD:.7555,CADEUR:.6998}},xt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ft,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LANG":return ut(e,{lang:t.lang});case"SET_CURRENCY":return ut(e,{currency:t.currency});default:return e}},Lt=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||ot.d,Mt=Object(ot.c)({products:_t,nav:gt,auth:Nt,suppliers:St,error:Ct,publicity:Ut,parameters:xt}),At=Object(ot.e)(Mt,Lt(Object(ot.a)(lt.a)));c.a.render(r.a.createElement(p.a,{store:At},r.a.createElement(i.a,null,r.a.createElement(it,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[123,1,2]]]);
//# sourceMappingURL=main.0ec65ccc.chunk.js.map